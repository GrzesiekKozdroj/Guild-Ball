let mouX,mouY;!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],i=e.document,o=Object.getPrototypeOf,a=n.slice,s=n.concat,r=n.push,l=n.indexOf,c={},d=c.toString,u=c.hasOwnProperty,p=u.toString,h=p.call(Object),m={},f=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},g=function(e){return null!=e&&e===e.window},v={type:!0,src:!0,noModule:!0};function y(e,t,n){var o,a=(t=t||i).createElement("script");if(a.text=e,n)for(o in v)n[o]&&(a[o]=n[o]);t.head.appendChild(a).parentNode.removeChild(a)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[d.call(e)]||"object":typeof e}var x=function(e,t){return new x.fn.init(e,t)},k=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function w(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!f(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}x.fn=x.prototype={jquery:"3.3.1",constructor:x,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return x.each(this,e)},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:r,sort:n.sort,splice:n.splice},x.extend=x.fn.extend=function(){var e,t,n,i,o,a,s=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[r]||{},r++),"object"==typeof s||f(s)||(s={}),r===l&&(s=this,r--);r<l;r++)if(null!=(e=arguments[r]))for(t in e)n=s[t],s!==(i=e[t])&&(c&&i&&(x.isPlainObject(i)||(o=Array.isArray(i)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(c,a,i)):void 0!==i&&(s[t]=i));return s},x.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==d.call(e))&&(!(t=o(e))||"function"==typeof(n=u.call(t,"constructor")&&t.constructor)&&p.call(n)===h)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){y(e)},each:function(e,t){var n,i=0;if(w(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(k,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(w(Object(e))?x.merge(n,"string"==typeof e?[e]:e):r.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:l.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;i<n;i++)e[o++]=t[i];return e.length=o,e},grep:function(e,t,n){for(var i=[],o=0,a=e.length,s=!n;o<a;o++)!t(e[o],o)!==s&&i.push(e[o]);return i},map:function(e,t,n){var i,o,a=0,r=[];if(w(e))for(i=e.length;a<i;a++)null!=(o=t(e[a],a,n))&&r.push(o);else for(a in e)null!=(o=t(e[a],a,n))&&r.push(o);return s.apply([],r)},guid:1,support:m}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=n[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});var $=function(e){var t,n,i,o,a,s,r,l,c,d,u,p,h,m,f,g,v,y,b,x="sizzle"+1*new Date,k=e.document,w=0,$=0,G=se(),C=se(),R=se(),S=function(e,t){return e===t&&(u=!0),0},T={}.hasOwnProperty,X=[],D=X.pop,B=X.push,Y=X.push,M=X.slice,A=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",q="[\\x20\\t\\r\\n\\f]",E="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+q+"*("+E+")(?:"+q+"*([*^$|!~]?=)"+q+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+E+"))|)"+q+"*\\]",W=":("+E+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",H=new RegExp(q+"+","g"),I=new RegExp("^"+q+"+|((?:^|[^\\\\])(?:\\\\.)*)"+q+"+$","g"),N=new RegExp("^"+q+"*,"+q+"*"),z=new RegExp("^"+q+"*([>+~]|"+q+")"+q+"*"),F=new RegExp("="+q+"*([^\\]'\"]*?)"+q+"*\\]","g"),O=new RegExp(W),L=new RegExp("^"+E+"$"),K={ID:new RegExp("^#("+E+")"),CLASS:new RegExp("^\\.("+E+")"),TAG:new RegExp("^("+E+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+q+"*(even|odd|(([+-]|)(\\d*)n|)"+q+"*(?:([+-]|)"+q+"*(\\d+)|))"+q+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+q+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+q+"*((?:-\\d)?\\d*)"+q+"*\\)|)(?=[^-]|$)","i")},_=/^(?:input|select|textarea|button)$/i,U=/^h\d$/i,V=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,Q=new RegExp("\\\\([\\da-f]{1,6}"+q+"?|("+q+")|.)","ig"),ee=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ie=function(){p()},oe=ye(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Y.apply(X=M.call(k.childNodes),k.childNodes),X[k.childNodes.length].nodeType}catch(e){Y={apply:X.length?function(e,t){B.apply(e,M.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function ae(e,t,i,o){var a,r,c,d,u,m,v,y=t&&t.ownerDocument,w=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return i;if(!o&&((t?t.ownerDocument||t:k)!==h&&p(t),t=t||h,f)){if(11!==w&&(u=Z.exec(e)))if(a=u[1]){if(9===w){if(!(c=t.getElementById(a)))return i;if(c.id===a)return i.push(c),i}else if(y&&(c=y.getElementById(a))&&b(t,c)&&c.id===a)return i.push(c),i}else{if(u[2])return Y.apply(i,t.getElementsByTagName(e)),i;if((a=u[3])&&n.getElementsByClassName&&t.getElementsByClassName)return Y.apply(i,t.getElementsByClassName(a)),i}if(n.qsa&&!R[e+" "]&&(!g||!g.test(e))){if(1!==w)y=t,v=e;else if("object"!==t.nodeName.toLowerCase()){for((d=t.getAttribute("id"))?d=d.replace(te,ne):t.setAttribute("id",d=x),r=(m=s(e)).length;r--;)m[r]="#"+d+" "+ve(m[r]);v=m.join(","),y=J.test(e)&&fe(t.parentNode)||t}if(v)try{return Y.apply(i,y.querySelectorAll(v)),i}catch(e){}finally{d===x&&t.removeAttribute("id")}}}return l(e.replace(I,"$1"),t,i,o)}function se(){var e=[];return function t(n,o){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=o}}function re(e){return e[x]=!0,e}function le(e){var t=h.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t){for(var n=e.split("|"),o=n.length;o--;)i.attrHandle[n[o]]=t}function de(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ue(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function he(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&oe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return re(function(t){return t=+t,re(function(n,i){for(var o,a=e([],n.length,t),s=a.length;s--;)n[o=a[s]]&&(n[o]=!(i[o]=n[o]))})})}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=ae.support={},a=ae.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=ae.setDocument=function(e){var t,o,s=e?e.ownerDocument||e:k;return s!==h&&9===s.nodeType&&s.documentElement?(m=(h=s).documentElement,f=!a(h),k!==h&&(o=h.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",ie,!1):o.attachEvent&&o.attachEvent("onunload",ie)),n.attributes=le(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=le(function(e){return e.appendChild(h.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=V.test(h.getElementsByClassName),n.getById=le(function(e){return m.appendChild(e).id=x,!h.getElementsByName||!h.getElementsByName(x).length}),n.getById?(i.filter.ID=function(e){var t=e.replace(Q,ee);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(Q,ee);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var n,i,o,a=t.getElementById(e);if(a){if((n=a.getAttributeNode("id"))&&n.value===e)return[a];for(o=t.getElementsByName(e),i=0;a=o[i++];)if((n=a.getAttributeNode("id"))&&n.value===e)return[a]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,a=t.getElementsByTagName(e);if("*"===e){for(;n=a[o++];)1===n.nodeType&&i.push(n);return i}return a},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},v=[],g=[],(n.qsa=V.test(h.querySelectorAll))&&(le(function(e){m.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+q+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+q+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+x+"-]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]")}),le(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=h.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+q+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(n.matchesSelector=V.test(y=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&le(function(e){n.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),v.push("!=",W)}),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),t=V.test(m.compareDocumentPosition),b=t||V.test(m.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},S=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e===h||e.ownerDocument===k&&b(k,e)?-1:t===h||t.ownerDocument===k&&b(k,t)?1:d?A(d,e)-A(d,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,i=0,o=e.parentNode,a=t.parentNode,s=[e],r=[t];if(!o||!a)return e===h?-1:t===h?1:o?-1:a?1:d?A(d,e)-A(d,t):0;if(o===a)return de(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)r.unshift(n);for(;s[i]===r[i];)i++;return i?de(s[i],r[i]):s[i]===k?-1:r[i]===k?1:0},h):h},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&p(e),t=t.replace(F,"='$1']"),n.matchesSelector&&f&&!R[t+" "]&&(!v||!v.test(t))&&(!g||!g.test(t)))try{var i=y.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return ae(t,h,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!==h&&p(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!==h&&p(e);var o=i.attrHandle[t.toLowerCase()],a=o&&T.call(i.attrHandle,t.toLowerCase())?o(e,t,!f):void 0;return void 0!==a?a:n.attributes||!f?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null},ae.escape=function(e){return(e+"").replace(te,ne)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,i=[],o=0,a=0;if(u=!n.detectDuplicates,d=!n.sortStable&&e.slice(0),e.sort(S),u){for(;t=e[a++];)t===e[a]&&(o=i.push(a));for(;o--;)e.splice(i[o],1)}return d=null,e},o=ae.getText=function(e){var t,n="",i=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[i++];)n+=o(t);return n},(i=ae.selectors={cacheLength:50,createPseudo:re,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Q,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Q,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&O.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Q,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=G[e+" "];return t||(t=new RegExp("(^|"+q+")"+e+"("+q+"|$)"))&&G(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var o=ae.attr(i,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o.replace(H," ")+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,o){var a="nth"!==e.slice(0,3),s="last"!==e.slice(-4),r="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,p,h,m,f=a!==s?"nextSibling":"previousSibling",g=t.parentNode,v=r&&t.nodeName.toLowerCase(),y=!l&&!r,b=!1;if(g){if(a){for(;f;){for(p=t;p=p[f];)if(r?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[s?g.firstChild:g.lastChild],s&&y){for(b=(h=(c=(d=(u=(p=g)[x]||(p[x]={}))[p.uniqueID]||(u[p.uniqueID]={}))[e]||[])[0]===w&&c[1])&&c[2],p=h&&g.childNodes[h];p=++h&&p&&p[f]||(b=h=0)||m.pop();)if(1===p.nodeType&&++b&&p===t){d[e]=[w,h,b];break}}else if(y&&(b=h=(c=(d=(u=(p=t)[x]||(p[x]={}))[p.uniqueID]||(u[p.uniqueID]={}))[e]||[])[0]===w&&c[1]),!1===b)for(;(p=++h&&p&&p[f]||(b=h=0)||m.pop())&&((r?p.nodeName.toLowerCase()!==v:1!==p.nodeType)||!++b||(y&&((d=(u=p[x]||(p[x]={}))[p.uniqueID]||(u[p.uniqueID]={}))[e]=[w,b]),p!==t)););return(b-=o)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,o=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return o[x]?o(t):o.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?re(function(e,n){for(var i,a=o(e,t),s=a.length;s--;)e[i=A(e,a[s])]=!(n[i]=a[s])}):function(e){return o(e,0,n)}):o}},pseudos:{not:re(function(e){var t=[],n=[],i=r(e.replace(I,"$1"));return i[x]?re(function(e,t,n,o){for(var a,s=i(e,null,o,[]),r=e.length;r--;)(a=s[r])&&(e[r]=!(t[r]=a))}):function(e,o,a){return t[0]=e,i(t,null,a,n),t[0]=null,!n.pop()}}),has:re(function(e){return function(t){return ae(e,t).length>0}}),contains:re(function(e){return e=e.replace(Q,ee),function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:re(function(e){return L.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(Q,ee).toLowerCase(),function(t){var n;do{if(n=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:he(!1),disabled:he(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return U.test(e.nodeName)},input:function(e){return _.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,n){return[n<0?n+t:n]}),even:me(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:me(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:me(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:me(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=ue(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=pe(t);function ge(){}function ve(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function ye(e,t,n){var i=t.dir,o=t.next,a=o||i,s=n&&"parentNode"===a,r=$++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,o);return!1}:function(t,n,l){var c,d,u,p=[w,r];if(l){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(d=(u=t[x]||(t[x]={}))[t.uniqueID]||(u[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[i]||t;else{if((c=d[a])&&c[0]===w&&c[1]===r)return p[2]=c[2];if(d[a]=p,p[2]=e(t,n,l))return!0}return!1}}function be(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function xe(e,t,n,i,o){for(var a,s=[],r=0,l=e.length,c=null!=t;r<l;r++)(a=e[r])&&(n&&!n(a,i,o)||(s.push(a),c&&t.push(r)));return s}function ke(e,t,n,i,o,a){return i&&!i[x]&&(i=ke(i)),o&&!o[x]&&(o=ke(o,a)),re(function(a,s,r,l){var c,d,u,p=[],h=[],m=s.length,f=a||function(e,t,n){for(var i=0,o=t.length;i<o;i++)ae(e,t[i],n);return n}(t||"*",r.nodeType?[r]:r,[]),g=!e||!a&&t?f:xe(f,p,e,r,l),v=n?o||(a?e:m||i)?[]:s:g;if(n&&n(g,v,r,l),i)for(c=xe(v,h),i(c,[],r,l),d=c.length;d--;)(u=c[d])&&(v[h[d]]=!(g[h[d]]=u));if(a){if(o||e){if(o){for(c=[],d=v.length;d--;)(u=v[d])&&c.push(g[d]=u);o(null,v=[],c,l)}for(d=v.length;d--;)(u=v[d])&&(c=o?A(a,u):p[d])>-1&&(a[c]=!(s[c]=u))}}else v=xe(v===s?v.splice(m,v.length):v),o?o(null,s,v,l):Y.apply(s,v)})}function we(e){for(var t,n,o,a=e.length,s=i.relative[e[0].type],r=s||i.relative[" "],l=s?1:0,d=ye(function(e){return e===t},r,!0),u=ye(function(e){return A(t,e)>-1},r,!0),p=[function(e,n,i){var o=!s&&(i||n!==c)||((t=n).nodeType?d(e,n,i):u(e,n,i));return t=null,o}];l<a;l++)if(n=i.relative[e[l].type])p=[ye(be(p),n)];else{if((n=i.filter[e[l].type].apply(null,e[l].matches))[x]){for(o=++l;o<a&&!i.relative[e[o].type];o++);return ke(l>1&&be(p),l>1&&ve(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(I,"$1"),n,l<o&&we(e.slice(l,o)),o<a&&we(e=e.slice(o)),o<a&&ve(e))}p.push(n)}return be(p)}return ge.prototype=i.filters=i.pseudos,i.setFilters=new ge,s=ae.tokenize=function(e,t){var n,o,a,s,r,l,c,d=C[e+" "];if(d)return t?0:d.slice(0);for(r=e,l=[],c=i.preFilter;r;){for(s in n&&!(o=N.exec(r))||(o&&(r=r.slice(o[0].length)||r),l.push(a=[])),n=!1,(o=z.exec(r))&&(n=o.shift(),a.push({value:n,type:o[0].replace(I," ")}),r=r.slice(n.length)),i.filter)!(o=K[s].exec(r))||c[s]&&!(o=c[s](o))||(n=o.shift(),a.push({value:n,type:s,matches:o}),r=r.slice(n.length));if(!n)break}return t?r.length:r?ae.error(e):C(e,l).slice(0)},r=ae.compile=function(e,t){var n,o=[],a=[],r=R[e+" "];if(!r){for(t||(t=s(e)),n=t.length;n--;)(r=we(t[n]))[x]?o.push(r):a.push(r);(r=R(e,function(e,t){var n=t.length>0,o=e.length>0,a=function(a,s,r,l,d){var u,m,g,v=0,y="0",b=a&&[],x=[],k=c,$=a||o&&i.find.TAG("*",d),G=w+=null==k?1:Math.random()||.1,C=$.length;for(d&&(c=s===h||s||d);y!==C&&null!=(u=$[y]);y++){if(o&&u){for(m=0,s||u.ownerDocument===h||(p(u),r=!f);g=e[m++];)if(g(u,s||h,r)){l.push(u);break}d&&(w=G)}n&&((u=!g&&u)&&v--,a&&b.push(u))}if(v+=y,n&&y!==v){for(m=0;g=t[m++];)g(b,x,s,r);if(a){if(v>0)for(;y--;)b[y]||x[y]||(x[y]=D.call(l));x=xe(x)}Y.apply(l,x),d&&!a&&x.length>0&&v+t.length>1&&ae.uniqueSort(l)}return d&&(w=G,c=k),b};return n?re(a):a}(a,o))).selector=e}return r},l=ae.select=function(e,t,n,o){var a,l,c,d,u,p="function"==typeof e&&e,h=!o&&s(e=p.selector||e);if(n=n||[],1===h.length){if((l=h[0]=h[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&f&&i.relative[l[1].type]){if(!(t=(i.find.ID(c.matches[0].replace(Q,ee),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(a=K.needsContext.test(e)?0:l.length;a--&&(c=l[a],!i.relative[d=c.type]);)if((u=i.find[d])&&(o=u(c.matches[0].replace(Q,ee),J.test(l[0].type)&&fe(t.parentNode)||t))){if(l.splice(a,1),!(e=o.length&&ve(l)))return Y.apply(n,o),n;break}}return(p||r(e,h))(o,t,!f,n,!t||J.test(e)&&fe(t.parentNode)||t),n},n.sortStable=x.split("").sort(S).join("")===x,n.detectDuplicates=!!u,p(),n.sortDetached=le(function(e){return 1&e.compareDocumentPosition(h.createElement("fieldset"))}),le(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ce("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&le(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ce("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),le(function(e){return null==e.getAttribute("disabled")})||ce(P,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),ae}(e);x.find=$,x.expr=$.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=$.uniqueSort,x.text=$.getText,x.isXMLDoc=$.isXML,x.contains=$.contains,x.escapeSelector=$.escape;var G=function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&x(e).is(n))break;i.push(e)}return i},C=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},R=x.expr.match.needsContext;function S(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var T=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function X(e,t,n){return f(t)?x.grep(e,function(e,i){return!!t.call(e,i,e)!==n}):t.nodeType?x.grep(e,function(e){return e===t!==n}):"string"!=typeof t?x.grep(e,function(e){return l.call(t,e)>-1!==n}):x.filter(t,e,n)}x.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?x.find.matchesSelector(i,e)?[i]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},x.fn.extend({find:function(e){var t,n,i=this.length,o=this;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;t<i;t++)if(x.contains(o[t],this))return!0}));for(n=this.pushStack([]),t=0;t<i;t++)x.find(e,o[t],n);return i>1?x.uniqueSort(n):n},filter:function(e){return this.pushStack(X(this,e||[],!1))},not:function(e){return this.pushStack(X(this,e||[],!0))},is:function(e){return!!X(this,"string"==typeof e&&R.test(e)?x(e):e||[],!1).length}});var D,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(e,t,n){var o,a;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(o="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:B.exec(e))||!o[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:i,!0)),T.test(o[1])&&x.isPlainObject(t))for(o in t)f(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}return(a=i.getElementById(o[2]))&&(this[0]=a,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):f(e)?void 0!==n.ready?n.ready(e):e(x):x.makeArray(e,this)}).prototype=x.fn,D=x(i);var Y=/^(?:parents|prev(?:Until|All))/,M={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}x.fn.extend({has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(x.contains(this,t[e]))return!0})},closest:function(e,t){var n,i=0,o=this.length,a=[],s="string"!=typeof e&&x(e);if(!R.test(e))for(;i<o;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){a.push(n);break}return this.pushStack(a.length>1?x.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?l.call(x(e),this[0]):l.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return G(e,"parentNode")},parentsUntil:function(e,t,n){return G(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return G(e,"nextSibling")},prevAll:function(e){return G(e,"previousSibling")},nextUntil:function(e,t,n){return G(e,"nextSibling",n)},prevUntil:function(e,t,n){return G(e,"previousSibling",n)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){return S(e,"iframe")?e.contentDocument:(S(e,"template")&&(e=e.content||e),x.merge([],e.childNodes))}},function(e,t){x.fn[e]=function(n,i){var o=x.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=x.filter(i,o)),this.length>1&&(M[e]||x.uniqueSort(o),Y.test(e)&&o.reverse()),this.pushStack(o)}});var P=/[^\x20\t\r\n\f]+/g;function q(e){return e}function E(e){throw e}function j(e,t,n,i){var o;try{e&&f(o=e.promise)?o.call(e).done(t).fail(n):e&&f(o=e.then)?o.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}x.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return x.each(e.match(P)||[],function(e,n){t[n]=!0}),t}(e):x.extend({},e);var t,n,i,o,a=[],s=[],r=-1,l=function(){for(o=o||e.once,i=t=!0;s.length;r=-1)for(n=s.shift();++r<a.length;)!1===a[r].apply(n[0],n[1])&&e.stopOnFalse&&(r=a.length,n=!1);e.memory||(n=!1),t=!1,o&&(a=n?[]:"")},c={add:function(){return a&&(n&&!t&&(r=a.length-1,s.push(n)),function t(n){x.each(n,function(n,i){f(i)?e.unique&&c.has(i)||a.push(i):i&&i.length&&"string"!==b(i)&&t(i)})}(arguments),n&&!t&&l()),this},remove:function(){return x.each(arguments,function(e,t){for(var n;(n=x.inArray(t,a,n))>-1;)a.splice(n,1),n<=r&&r--}),this},has:function(e){return e?x.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return o=s=[],a=n="",this},disabled:function(){return!a},lock:function(){return o=s=[],n||t||(a=n=""),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},x.extend({Deferred:function(t){var n=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],i="pending",o={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return x.Deferred(function(t){x.each(n,function(n,i){var o=f(e[i[4]])&&e[i[4]];a[i[1]](function(){var e=o&&o.apply(this,arguments);e&&f(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[i[0]+"With"](this,o?[e]:arguments)})}),e=null}).promise()},then:function(t,i,o){var a=0;function s(t,n,i,o){return function(){var r=this,l=arguments,c=function(){var e,c;if(!(t<a)){if((e=i.apply(r,l))===n.promise())throw new TypeError("Thenable self-resolution");c=e&&("object"==typeof e||"function"==typeof e)&&e.then,f(c)?o?c.call(e,s(a,n,q,o),s(a,n,E,o)):(a++,c.call(e,s(a,n,q,o),s(a,n,E,o),s(a,n,q,n.notifyWith))):(i!==q&&(r=void 0,l=[e]),(o||n.resolveWith)(r,l))}},d=o?c:function(){try{c()}catch(e){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(e,d.stackTrace),t+1>=a&&(i!==E&&(r=void 0,l=[e]),n.rejectWith(r,l))}};t?d():(x.Deferred.getStackHook&&(d.stackTrace=x.Deferred.getStackHook()),e.setTimeout(d))}}return x.Deferred(function(e){n[0][3].add(s(0,e,f(o)?o:q,e.notifyWith)),n[1][3].add(s(0,e,f(t)?t:q)),n[2][3].add(s(0,e,f(i)?i:E))}).promise()},promise:function(e){return null!=e?x.extend(e,o):o}},a={};return x.each(n,function(e,t){var s=t[2],r=t[5];o[t[1]]=s.add,r&&s.add(function(){i=r},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),a[t[0]]=function(){return a[t[0]+"With"](this===a?void 0:this,arguments),this},a[t[0]+"With"]=s.fireWith}),o.promise(a),t&&t.call(a,a),a},when:function(e){var t=arguments.length,n=t,i=Array(n),o=a.call(arguments),s=x.Deferred(),r=function(e){return function(n){i[e]=this,o[e]=arguments.length>1?a.call(arguments):n,--t||s.resolveWith(i,o)}};if(t<=1&&(j(e,s.done(r(n)).resolve,s.reject,!t),"pending"===s.state()||f(o[n]&&o[n].then)))return s.then();for(;n--;)j(o[n],r(n),s.reject);return s.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&W.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},x.readyException=function(t){e.setTimeout(function(){throw t})};var H=x.Deferred();function I(){i.removeEventListener("DOMContentLoaded",I),e.removeEventListener("load",I),x.ready()}x.fn.ready=function(e){return H.then(e).catch(function(e){x.readyException(e)}),this},x.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==e&&--x.readyWait>0||H.resolveWith(i,[x]))}}),x.ready.then=H.then,"complete"===i.readyState||"loading"!==i.readyState&&!i.documentElement.doScroll?e.setTimeout(x.ready):(i.addEventListener("DOMContentLoaded",I),e.addEventListener("load",I));var N=function(e,t,n,i,o,a,s){var r=0,l=e.length,c=null==n;if("object"===b(n))for(r in o=!0,n)N(e,t,r,n[r],!0,a,s);else if(void 0!==i&&(o=!0,f(i)||(s=!0),c&&(s?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(x(e),n)})),t))for(;r<l;r++)t(e[r],n,s?i:i.call(e[r],r,t(e[r],n)));return o?e:c?t.call(e):l?t(e[0],n):a},z=/^-ms-/,F=/-([a-z])/g;function O(e,t){return t.toUpperCase()}function L(e){return e.replace(z,"ms-").replace(F,O)}var K=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function _(){this.expando=x.expando+_.uid++}_.uid=1,_.prototype={cache:function(e){var t=e[this.expando];return t||(t={},K(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,o=this.cache(e);if("string"==typeof t)o[L(t)]=n;else for(i in t)o[L(i)]=t[i];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][L(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(L):(t=L(t))in i?[t]:t.match(P)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||x.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!x.isEmptyObject(t)}};var U=new _,V=new _,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,J=/[A-Z]/g;function Q(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(J,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Z.test(e)?JSON.parse(e):e)}(n)}catch(e){}V.set(e,t,n)}else n=void 0;return n}x.extend({hasData:function(e){return V.hasData(e)||U.hasData(e)},data:function(e,t,n){return V.access(e,t,n)},removeData:function(e,t){V.remove(e,t)},_data:function(e,t,n){return U.access(e,t,n)},_removeData:function(e,t){U.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,i,o,a=this[0],s=a&&a.attributes;if(void 0===e){if(this.length&&(o=V.get(a),1===a.nodeType&&!U.get(a,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=L(i.slice(5)),Q(a,i,o[i]));U.set(a,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){V.set(this,e)}):N(this,function(t){var n;if(a&&void 0===t)return void 0!==(n=V.get(a,e))?n:void 0!==(n=Q(a,e))?n:void 0;this.each(function(){V.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){V.remove(this,e)})}}),x.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=U.get(e,t),n&&(!i||Array.isArray(n)?i=U.access(e,t,x.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),i=n.length,o=n.shift(),a=x._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete a.stop,o.call(e,function(){x.dequeue(e,t)},a)),!i&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return U.get(e,n)||U.access(e,n,{empty:x.Callbacks("once memory").add(function(){U.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?x.queue(this[0],e):void 0===t?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=x.Deferred(),a=this,s=this.length,r=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=U.get(a[s],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(r));return r(),o.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],ie=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&x.contains(e.ownerDocument,e)&&"none"===x.css(e,"display")},oe=function(e,t,n,i){var o,a,s={};for(a in t)s[a]=e.style[a],e.style[a]=t[a];for(a in o=n.apply(e,i||[]),t)e.style[a]=s[a];return o};function ae(e,t,n,i){var o,a,s=20,r=i?function(){return i.cur()}:function(){return x.css(e,t,"")},l=r(),c=n&&n[3]||(x.cssNumber[t]?"":"px"),d=(x.cssNumber[t]||"px"!==c&&+l)&&te.exec(x.css(e,t));if(d&&d[3]!==c){for(l/=2,c=c||d[3],d=+l||1;s--;)x.style(e,t,d+c),(1-a)*(1-(a=r()/l||.5))<=0&&(s=0),d/=a;d*=2,x.style(e,t,d+c),n=n||[]}return n&&(d=+d||+l||0,o=n[1]?d+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=d,i.end=o)),o}var se={};function re(e){var t,n=e.ownerDocument,i=e.nodeName,o=se[i];return o||(t=n.body.appendChild(n.createElement(i)),o=x.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),se[i]=o,o)}function le(e,t){for(var n,i,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(n=i.style.display,t?("none"===n&&(o[a]=U.get(i,"display")||null,o[a]||(i.style.display="")),""===i.style.display&&ie(i)&&(o[a]=re(i))):"none"!==n&&(o[a]="none",U.set(i,"display",n)));for(a=0;a<s;a++)null!=o[a]&&(e[a].style.display=o[a]);return e}x.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ie(this)?x(this).show():x(this).hide()})}});var ce=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ue=/^$|^module$|\/(?:java|ecma)script/i,pe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function he(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&S(e,t)?x.merge([e],n):n}function me(e,t){for(var n=0,i=e.length;n<i;n++)U.set(e[n],"globalEval",!t||U.get(t[n],"globalEval"))}pe.optgroup=pe.option,pe.tbody=pe.tfoot=pe.colgroup=pe.caption=pe.thead,pe.th=pe.td;var fe,ge,ve=/<|&#?\w+;/;function ye(e,t,n,i,o){for(var a,s,r,l,c,d,u=t.createDocumentFragment(),p=[],h=0,m=e.length;h<m;h++)if((a=e[h])||0===a)if("object"===b(a))x.merge(p,a.nodeType?[a]:a);else if(ve.test(a)){for(s=s||u.appendChild(t.createElement("div")),r=(de.exec(a)||["",""])[1].toLowerCase(),l=pe[r]||pe._default,s.innerHTML=l[1]+x.htmlPrefilter(a)+l[2],d=l[0];d--;)s=s.lastChild;x.merge(p,s.childNodes),(s=u.firstChild).textContent=""}else p.push(t.createTextNode(a));for(u.textContent="",h=0;a=p[h++];)if(i&&x.inArray(a,i)>-1)o&&o.push(a);else if(c=x.contains(a.ownerDocument,a),s=he(u.appendChild(a),"script"),c&&me(s),n)for(d=0;a=s[d++];)ue.test(a.type||"")&&n.push(a);return u}fe=i.createDocumentFragment().appendChild(i.createElement("div")),(ge=i.createElement("input")).setAttribute("type","radio"),ge.setAttribute("checked","checked"),ge.setAttribute("name","t"),fe.appendChild(ge),m.checkClone=fe.cloneNode(!0).cloneNode(!0).lastChild.checked,fe.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!fe.cloneNode(!0).lastChild.defaultValue;var be=i.documentElement,xe=/^key/,ke=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,we=/^([^.]*)(?:\.(.+)|)/;function $e(){return!0}function Ge(){return!1}function Ce(){try{return i.activeElement}catch(e){}}function Re(e,t,n,i,o,a){var s,r;if("object"==typeof t){for(r in"string"!=typeof n&&(i=i||n,n=void 0),t)Re(e,r,n,i,t[r],a);return e}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),!1===o)o=Ge;else if(!o)return e;return 1===a&&(s=o,(o=function(e){return x().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=x.guid++)),e.each(function(){x.event.add(this,t,o,i,n)})}x.event={global:{},add:function(e,t,n,i,o){var a,s,r,l,c,d,u,p,h,m,f,g=U.get(e);if(g)for(n.handler&&(n=(a=n).handler,o=a.selector),o&&x.find.matchesSelector(be,o),n.guid||(n.guid=x.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(t){return void 0!==x&&x.event.triggered!==t.type?x.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(P)||[""]).length;c--;)h=f=(r=we.exec(t[c])||[])[1],m=(r[2]||"").split(".").sort(),h&&(u=x.event.special[h]||{},h=(o?u.delegateType:u.bindType)||h,u=x.event.special[h]||{},d=x.extend({type:h,origType:f,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:m.join(".")},a),(p=l[h])||((p=l[h]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,i,m,s)||e.addEventListener&&e.addEventListener(h,s)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),x.event.global[h]=!0)},remove:function(e,t,n,i,o){var a,s,r,l,c,d,u,p,h,m,f,g=U.hasData(e)&&U.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(P)||[""]).length;c--;)if(h=f=(r=we.exec(t[c])||[])[1],m=(r[2]||"").split(".").sort(),h){for(u=x.event.special[h]||{},p=l[h=(i?u.delegateType:u.bindType)||h]||[],r=r[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=p.length;a--;)d=p[a],!o&&f!==d.origType||n&&n.guid!==d.guid||r&&!r.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(p.splice(a,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(e,d));s&&!p.length&&(u.teardown&&!1!==u.teardown.call(e,m,g.handle)||x.removeEvent(e,h,g.handle),delete l[h])}else for(h in l)x.event.remove(e,h+t[c],n,i,!0);x.isEmptyObject(l)&&U.remove(e,"handle events")}},dispatch:function(e){var t,n,i,o,a,s,r=x.event.fix(e),l=new Array(arguments.length),c=(U.get(this,"events")||{})[r.type]||[],d=x.event.special[r.type]||{};for(l[0]=r,t=1;t<arguments.length;t++)l[t]=arguments[t];if(r.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,r)){for(s=x.event.handlers.call(this,r,c),t=0;(o=s[t++])&&!r.isPropagationStopped();)for(r.currentTarget=o.elem,n=0;(a=o.handlers[n++])&&!r.isImmediatePropagationStopped();)r.rnamespace&&!r.rnamespace.test(a.namespace)||(r.handleObj=a,r.data=a.data,void 0!==(i=((x.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l))&&!1===(r.result=i)&&(r.preventDefault(),r.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,r),r.result}},handlers:function(e,t){var n,i,o,a,s,r=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(a=[],s={},n=0;n<l;n++)void 0===s[o=(i=t[n]).selector+" "]&&(s[o]=i.needsContext?x(o,this).index(c)>-1:x.find(o,this,null,[c]).length),s[o]&&a.push(i);a.length&&r.push({elem:c,handlers:a})}return c=this,l<t.length&&r.push({elem:c,handlers:t.slice(l)}),r},addProp:function(e,t){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[x.expando]?e:new x.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Ce()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Ce()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&S(this,"input"))return this.click(),!1},_default:function(e){return S(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},x.Event=function(e,t){if(!(this instanceof x.Event))return new x.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?$e:Ge,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Ge,isPropagationStopped:Ge,isImmediatePropagationStopped:Ge,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=$e,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=$e,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=$e,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&xe.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&ke.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},x.event.addProp),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,o=e.handleObj;return i&&(i===this||x.contains(this,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.fn.extend({on:function(e,t,n,i){return Re(this,e,t,n,i)},one:function(e,t,n,i){return Re(this,e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ge),this.each(function(){x.event.remove(this,e,n,t)})}});var Se=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Te=/<script|<style|<link/i,Xe=/checked\s*(?:[^=]|=\s*.checked.)/i,De=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Be(e,t){return S(e,"table")&&S(11!==t.nodeType?t:t.firstChild,"tr")&&x(e).children("tbody")[0]||e}function Ye(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Me(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ae(e,t){var n,i,o,a,s,r,l,c;if(1===t.nodeType){if(U.hasData(e)&&(a=U.access(e),s=U.set(t,a),c=a.events))for(o in delete s.handle,s.events={},c)for(n=0,i=c[o].length;n<i;n++)x.event.add(t,o,c[o][n]);V.hasData(e)&&(r=V.access(e),l=x.extend({},r),V.set(t,l))}}function Pe(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ce.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function qe(e,t,n,i){t=s.apply([],t);var o,a,r,l,c,d,u=0,p=e.length,h=p-1,g=t[0],v=f(g);if(v||p>1&&"string"==typeof g&&!m.checkClone&&Xe.test(g))return e.each(function(o){var a=e.eq(o);v&&(t[0]=g.call(this,o,a.html())),qe(a,t,n,i)});if(p&&(a=(o=ye(t,e[0].ownerDocument,!1,e,i)).firstChild,1===o.childNodes.length&&(o=a),a||i)){for(l=(r=x.map(he(o,"script"),Ye)).length;u<p;u++)c=o,u!==h&&(c=x.clone(c,!0,!0),l&&x.merge(r,he(c,"script"))),n.call(e[u],c,u);if(l)for(d=r[r.length-1].ownerDocument,x.map(r,Me),u=0;u<l;u++)c=r[u],ue.test(c.type||"")&&!U.access(c,"globalEval")&&x.contains(d,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?x._evalUrl&&x._evalUrl(c.src):y(c.textContent.replace(De,""),d,c))}return e}function Ee(e,t,n){for(var i,o=t?x.filter(t,e):e,a=0;null!=(i=o[a]);a++)n||1!==i.nodeType||x.cleanData(he(i)),i.parentNode&&(n&&x.contains(i.ownerDocument,i)&&me(he(i,"script")),i.parentNode.removeChild(i));return e}x.extend({htmlPrefilter:function(e){return e.replace(Se,"<$1></$2>")},clone:function(e,t,n){var i,o,a,s,r=e.cloneNode(!0),l=x.contains(e.ownerDocument,e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=he(r),i=0,o=(a=he(e)).length;i<o;i++)Pe(a[i],s[i]);if(t)if(n)for(a=a||he(e),s=s||he(r),i=0,o=a.length;i<o;i++)Ae(a[i],s[i]);else Ae(e,r);return(s=he(r,"script")).length>0&&me(s,!l&&he(e,"script")),r},cleanData:function(e){for(var t,n,i,o=x.event.special,a=0;void 0!==(n=e[a]);a++)if(K(n)){if(t=n[U.expando]){if(t.events)for(i in t.events)o[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);n[U.expando]=void 0}n[V.expando]&&(n[V.expando]=void 0)}}}),x.fn.extend({detach:function(e){return Ee(this,e,!0)},remove:function(e){return Ee(this,e)},text:function(e){return N(this,function(e){return void 0===e?x.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return qe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Be(this,e).appendChild(e)})},prepend:function(){return qe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Be(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return qe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return qe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(he(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return N(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Te.test(e)&&!pe[(de.exec(e)||["",""])[1].toLowerCase()]){e=x.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(x.cleanData(he(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return qe(this,arguments,function(t){var n=this.parentNode;x.inArray(this,e)<0&&(x.cleanData(he(this)),n&&n.replaceChild(t,this))},e)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){for(var n,i=[],o=x(e),a=o.length-1,s=0;s<=a;s++)n=s===a?this:this.clone(!0),x(o[s])[t](n),r.apply(i,n.get());return this.pushStack(i)}});var je=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),We=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},He=new RegExp(ne.join("|"),"i");function Ie(e,t,n){var i,o,a,s,r=e.style;return(n=n||We(e))&&(""!==(s=n.getPropertyValue(t)||n[t])||x.contains(e.ownerDocument,e)||(s=x.style(e,t)),!m.pixelBoxStyles()&&je.test(s)&&He.test(t)&&(i=r.width,o=r.minWidth,a=r.maxWidth,r.minWidth=r.maxWidth=r.width=s,s=n.width,r.width=i,r.minWidth=o,r.maxWidth=a)),void 0!==s?s+"":s}function Ne(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(d){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(c).appendChild(d);var t=e.getComputedStyle(d);o="1%"!==t.top,l=12===n(t.marginLeft),d.style.right="60%",r=36===n(t.right),a=36===n(t.width),d.style.position="absolute",s=36===d.offsetWidth||"absolute",be.removeChild(c),d=null}}function n(e){return Math.round(parseFloat(e))}var o,a,s,r,l,c=i.createElement("div"),d=i.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===d.style.backgroundClip,x.extend(m,{boxSizingReliable:function(){return t(),a},pixelBoxStyles:function(){return t(),r},pixelPosition:function(){return t(),o},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),s}}))}();var ze=/^(none|table(?!-c[ea]).+)/,Fe=/^--/,Oe={position:"absolute",visibility:"hidden",display:"block"},Le={letterSpacing:"0",fontWeight:"400"},Ke=["Webkit","Moz","ms"],_e=i.createElement("div").style;function Ue(e){var t=x.cssProps[e];return t||(t=x.cssProps[e]=function(e){if(e in _e)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Ke.length;n--;)if((e=Ke[n]+t)in _e)return e}(e)||e),t}function Ve(e,t,n){var i=te.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function Ze(e,t,n,i,o,a){var s="width"===t?1:0,r=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=x.css(e,n+ne[s],!0,o)),i?("content"===n&&(l-=x.css(e,"padding"+ne[s],!0,o)),"margin"!==n&&(l-=x.css(e,"border"+ne[s]+"Width",!0,o))):(l+=x.css(e,"padding"+ne[s],!0,o),"padding"!==n?l+=x.css(e,"border"+ne[s]+"Width",!0,o):r+=x.css(e,"border"+ne[s]+"Width",!0,o));return!i&&a>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-r-.5))),l}function Je(e,t,n){var i=We(e),o=Ie(e,t,i),a="border-box"===x.css(e,"boxSizing",!1,i),s=a;if(je.test(o)){if(!n)return o;o="auto"}return s=s&&(m.boxSizingReliable()||o===e.style[t]),("auto"===o||!parseFloat(o)&&"inline"===x.css(e,"display",!1,i))&&(o=e["offset"+t[0].toUpperCase()+t.slice(1)],s=!0),(o=parseFloat(o)||0)+Ze(e,t,n||(a?"border":"content"),s,i,o)+"px"}function Qe(e,t,n,i,o){return new Qe.prototype.init(e,t,n,i,o)}x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ie(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,r=L(t),l=Fe.test(t),c=e.style;if(l||(t=Ue(r)),s=x.cssHooks[t]||x.cssHooks[r],void 0===n)return s&&"get"in s&&void 0!==(o=s.get(e,!1,i))?o:c[t];"string"===(a=typeof n)&&(o=te.exec(n))&&o[1]&&(n=ae(e,t,o),a="number"),null!=n&&n==n&&("number"===a&&(n+=o&&o[3]||(x.cssNumber[r]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var o,a,s,r=L(t);return Fe.test(t)||(t=Ue(r)),(s=x.cssHooks[t]||x.cssHooks[r])&&"get"in s&&(o=s.get(e,!0,n)),void 0===o&&(o=Ie(e,t,i)),"normal"===o&&t in Le&&(o=Le[t]),""===n||n?(a=parseFloat(o),!0===n||isFinite(a)?a||0:o):o}}),x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,i){if(n)return!ze.test(x.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,t,i):oe(e,Oe,function(){return Je(e,t,i)})},set:function(e,n,i){var o,a=We(e),s="border-box"===x.css(e,"boxSizing",!1,a),r=i&&Ze(e,t,i,s,a);return s&&m.scrollboxSize()===a.position&&(r-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-Ze(e,t,"border",!1,a)-.5)),r&&(o=te.exec(n))&&"px"!==(o[3]||"px")&&(e.style[t]=n,n=x.css(e,t)),Ve(0,n,r)}}}),x.cssHooks.marginLeft=Ne(m.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ie(e,"marginLeft"))||e.getBoundingClientRect().left-oe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){for(var i=0,o={},a="string"==typeof n?n.split(" "):[n];i<4;i++)o[e+ne[i]+t]=a[i]||a[i-2]||a[0];return o}},"margin"!==e&&(x.cssHooks[e+t].set=Ve)}),x.fn.extend({css:function(e,t){return N(this,function(e,t,n){var i,o,a={},s=0;if(Array.isArray(t)){for(i=We(e),o=t.length;s<o;s++)a[t[s]]=x.css(e,t[s],!1,i);return a}return void 0!==n?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)}}),x.Tween=Qe,Qe.prototype={constructor:Qe,init:function(e,t,n,i,o,a){this.elem=e,this.prop=n,this.easing=o||x.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=a||(x.cssNumber[n]?"":"px")},cur:function(){var e=Qe.propHooks[this.prop];return e&&e.get?e.get(this):Qe.propHooks._default.get(this)},run:function(e){var t,n=Qe.propHooks[this.prop];return this.options.duration?this.pos=t=x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Qe.propHooks._default.set(this),this}},Qe.prototype.init.prototype=Qe.prototype,Qe.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=x.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[x.cssProps[e.prop]]&&!x.cssHooks[e.prop]?e.elem[e.prop]=e.now:x.style(e.elem,e.prop,e.now+e.unit)}}},Qe.propHooks.scrollTop=Qe.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},x.fx=Qe.prototype.init,x.fx.step={};var et,tt,nt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){tt&&(!1===i.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(ot):e.setTimeout(ot,x.fx.interval),x.fx.tick())}function at(){return e.setTimeout(function(){et=void 0}),et=Date.now()}function st(e,t){var n,i=0,o={height:e};for(t=t?1:0;i<4;i+=2-t)o["margin"+(n=ne[i])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function rt(e,t,n){for(var i,o=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),a=0,s=o.length;a<s;a++)if(i=o[a].call(n,t,e))return i}function lt(e,t,n){var i,o,a=0,s=lt.prefilters.length,r=x.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=et||at(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),a=0,s=c.tweens.length;a<s;a++)c.tweens[a].run(i);return r.notifyWith(e,[c,i,n]),i<1&&s?n:(s||r.notifyWith(e,[c,1,0]),r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},n),originalProperties:t,originalOptions:n,startTime:et||at(),duration:n.duration,tweens:[],createTween:function(t,n){var i=x.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)c.tweens[n].run(1);return t?(r.notifyWith(e,[c,1,0]),r.resolveWith(e,[c,t])):r.rejectWith(e,[c,t]),this}}),d=c.props;for(!function(e,t){var n,i,o,a,s;for(n in e)if(o=t[i=L(n)],a=e[n],Array.isArray(a)&&(o=a[1],a=e[n]=a[0]),n!==i&&(e[i]=a,delete e[n]),(s=x.cssHooks[i])&&"expand"in s)for(n in a=s.expand(a),delete e[i],a)n in e||(e[n]=a[n],t[n]=o);else t[i]=o}(d,c.opts.specialEasing);a<s;a++)if(i=lt.prefilters[a].call(c,e,d,c.opts))return f(i.stop)&&(x._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return x.map(d,rt,c),f(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),x.fx.timer(x.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}x.Animation=x.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ae(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){f(e)?(t=e,e=["*"]):e=e.match(P);for(var n,i=0,o=e.length;i<o;i++)n=e[i],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,o,a,s,r,l,c,d,u="width"in t||"height"in t,p=this,h={},m=e.style,f=e.nodeType&&ie(e),g=U.get(e,"fxshow");for(i in n.queue||(null==(s=x._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,r=s.empty.fire,s.empty.fire=function(){s.unqueued||r()}),s.unqueued++,p.always(function(){p.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()})})),t)if(o=t[i],nt.test(o)){if(delete t[i],a=a||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[i])continue;f=!0}h[i]=g&&g[i]||x.style(e,i)}if((l=!x.isEmptyObject(t))||!x.isEmptyObject(h))for(i in u&&1===e.nodeType&&(n.overflow=[m.overflow,m.overflowX,m.overflowY],null==(c=g&&g.display)&&(c=U.get(e,"display")),"none"===(d=x.css(e,"display"))&&(c?d=c:(le([e],!0),c=e.style.display||c,d=x.css(e,"display"),le([e]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===x.css(e,"float")&&(l||(p.done(function(){m.display=c}),null==c&&(d=m.display,c="none"===d?"":d)),m.display="inline-block")),n.overflow&&(m.overflow="hidden",p.always(function(){m.overflow=n.overflow[0],m.overflowX=n.overflow[1],m.overflowY=n.overflow[2]})),l=!1,h)l||(g?"hidden"in g&&(f=g.hidden):g=U.access(e,"fxshow",{display:c}),a&&(g.hidden=!f),f&&le([e],!0),p.done(function(){for(i in f||le([e]),U.remove(e,"fxshow"),h)x.style(e,i,h[i])})),l=rt(f?g[i]:0,i,p),i in g||(g[i]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),x.speed=function(e,t,n){var i=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||f(e)&&e,duration:e,easing:n&&t||t&&!f(t)&&t};return x.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in x.fx.speeds?i.duration=x.fx.speeds[i.duration]:i.duration=x.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){f(i.old)&&i.old.call(this),i.queue&&x.dequeue(this,i.queue)},i},x.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ie).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=x.isEmptyObject(e),a=x.speed(t,n,i),s=function(){var t=lt(this,x.extend({},e),a);(o||U.get(this,"finish"))&&t.stop(!0)};return s.finish=s,o||!1===a.queue?this.each(s):this.queue(a.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",a=x.timers,s=U.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&it.test(o)&&i(s[o]);for(o=a.length;o--;)a[o].elem!==this||null!=e&&a[o].queue!==e||(a[o].anim.stop(n),t=!1,a.splice(o,1));!t&&n||x.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=U.get(this),i=n[e+"queue"],o=n[e+"queueHooks"],a=x.timers,s=i?i.length:0;for(n.finish=!0,x.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,i,o)}}),x.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),x.timers=[],x.fx.tick=function(){var e,t=0,n=x.timers;for(et=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||x.fx.stop(),et=void 0},x.fx.timer=function(e){x.timers.push(e),x.fx.start()},x.fx.interval=13,x.fx.start=function(){tt||(tt=!0,ot())},x.fx.stop=function(){tt=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(t,n){return t=x.fx&&x.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,i){var o=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(o)}})},function(){var e=i.createElement("input"),t=i.createElement("select").appendChild(i.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=i.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var ct,dt=x.expr.attrHandle;x.fn.extend({attr:function(e,t){return N(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})}}),x.extend({attr:function(e,t,n){var i,o,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?x.prop(e,t,n):(1===a&&x.isXMLDoc(e)||(o=x.attrHooks[t.toLowerCase()]||(x.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void x.removeAttr(e,t):o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:(e.setAttribute(t,n+""),n):o&&"get"in o&&null!==(i=o.get(e,t))?i:null==(i=x.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&S(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,o=t&&t.match(P);if(o&&1===e.nodeType)for(;n=o[i++];)e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=dt[t]||x.find.attr;dt[t]=function(e,t,i){var o,a,s=t.toLowerCase();return i||(a=dt[s],dt[s]=o,o=null!=n(e,t,i)?s:null,dt[s]=a),o}});var ut=/^(?:input|select|textarea|button)$/i,pt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function ft(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}x.fn.extend({prop:function(e,t){return N(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})}}),x.extend({prop:function(e,t,n){var i,o,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&x.isXMLDoc(e)||(t=x.propFix[t]||t,o=x.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):ut.test(e.nodeName)||pt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.fn.extend({addClass:function(e){var t,n,i,o,a,s,r,l=0;if(f(e))return this.each(function(t){x(this).addClass(e.call(this,t,mt(this)))});if((t=ft(e)).length)for(;n=this[l++];)if(o=mt(n),i=1===n.nodeType&&" "+ht(o)+" "){for(s=0;a=t[s++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");o!==(r=ht(i))&&n.setAttribute("class",r)}return this},removeClass:function(e){var t,n,i,o,a,s,r,l=0;if(f(e))return this.each(function(t){x(this).removeClass(e.call(this,t,mt(this)))});if(!arguments.length)return this.attr("class","");if((t=ft(e)).length)for(;n=this[l++];)if(o=mt(n),i=1===n.nodeType&&" "+ht(o)+" "){for(s=0;a=t[s++];)for(;i.indexOf(" "+a+" ")>-1;)i=i.replace(" "+a+" "," ");o!==(r=ht(i))&&n.setAttribute("class",r)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):f(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,mt(this),t),t)}):this.each(function(){var t,o,a,s;if(i)for(o=0,a=x(this),s=ft(e);t=s[o++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else void 0!==e&&"boolean"!==n||((t=mt(this))&&U.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":U.get(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+ht(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var gt=/\r/g;x.fn.extend({val:function(e){var t,n,i,o=this[0];return arguments.length?(i=f(e),this.each(function(n){var o;1===this.nodeType&&(null==(o=i?e.call(this,n,x(this).val()):e)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""})),(t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))})):o?(t=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(gt,""):null==n?"":n:void 0}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:ht(x.text(e))}},select:{get:function(e){var t,n,i,o=e.options,a=e.selectedIndex,s="select-one"===e.type,r=s?null:[],l=s?a+1:o.length;for(i=a<0?l:s?a:0;i<l;i++)if(((n=o[i]).selected||i===a)&&!n.disabled&&(!n.parentNode.disabled||!S(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;r.push(t)}return r},set:function(e,t){for(var n,i,o=e.options,a=x.makeArray(t),s=o.length;s--;)((i=o[s]).selected=x.inArray(x.valHooks.option.get(i),a)>-1)&&(n=!0);return n||(e.selectedIndex=-1),a}}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=x.inArray(x(e).val(),t)>-1}},m.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),m.focusin="onfocusin"in e;var vt=/^(?:focusinfocus|focusoutblur)$/,yt=function(e){e.stopPropagation()};x.extend(x.event,{trigger:function(t,n,o,a){var s,r,l,c,d,p,h,m,v=[o||i],y=u.call(t,"type")?t.type:t,b=u.call(t,"namespace")?t.namespace.split("."):[];if(r=m=l=o=o||i,3!==o.nodeType&&8!==o.nodeType&&!vt.test(y+x.event.triggered)&&(y.indexOf(".")>-1&&(b=y.split("."),y=b.shift(),b.sort()),d=y.indexOf(":")<0&&"on"+y,(t=t[x.expando]?t:new x.Event(y,"object"==typeof t&&t)).isTrigger=a?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=o),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[y]||{},a||!h.trigger||!1!==h.trigger.apply(o,n))){if(!a&&!h.noBubble&&!g(o)){for(c=h.delegateType||y,vt.test(c+y)||(r=r.parentNode);r;r=r.parentNode)v.push(r),l=r;l===(o.ownerDocument||i)&&v.push(l.defaultView||l.parentWindow||e)}for(s=0;(r=v[s++])&&!t.isPropagationStopped();)m=r,t.type=s>1?c:h.bindType||y,(p=(U.get(r,"events")||{})[t.type]&&U.get(r,"handle"))&&p.apply(r,n),(p=d&&r[d])&&p.apply&&K(r)&&(t.result=p.apply(r,n),!1===t.result&&t.preventDefault());return t.type=y,a||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(v.pop(),n)||!K(o)||d&&f(o[y])&&!g(o)&&((l=o[d])&&(o[d]=null),x.event.triggered=y,t.isPropagationStopped()&&m.addEventListener(y,yt),o[y](),t.isPropagationStopped()&&m.removeEventListener(y,yt),x.event.triggered=void 0,l&&(o[d]=l)),t.result}},simulate:function(e,t,n){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0});x.event.trigger(i,null,t)}}),x.fn.extend({trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return x.event.trigger(e,t,n,!0)}}),m.focusin||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){x.event.simulate(t,e.target,x.event.fix(e))};x.event.special[t]={setup:function(){var i=this.ownerDocument||this,o=U.access(i,t);o||i.addEventListener(e,n,!0),U.access(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=U.access(i,t)-1;o?U.access(i,t,o):(i.removeEventListener(e,n,!0),U.remove(i,t))}}});var bt=e.location,xt=Date.now(),kt=/\?/;x.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+t),n};var wt=/\[\]$/,$t=/\r?\n/g,Gt=/^(?:submit|button|image|reset|file)$/i,Ct=/^(?:input|select|textarea|keygen)/i;function Rt(e,t,n,i){var o;if(Array.isArray(t))x.each(t,function(t,o){n||wt.test(e)?i(e,o):Rt(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,n,i)});else if(n||"object"!==b(t))i(e,t);else for(o in t)Rt(e+"["+o+"]",t[o],n,i)}x.param=function(e,t){var n,i=[],o=function(e,t){var n=f(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){o(this.name,this.value)});else for(n in e)Rt(n,e[n],t,o);return i.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&Ct.test(this.nodeName)&&!Gt.test(e)&&(this.checked||!ce.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:Array.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace($t,"\r\n")}}):{name:t.name,value:n.replace($t,"\r\n")}}).get()}});var St=/%20/g,Tt=/#.*$/,Xt=/([?&])_=[^&]*/,Dt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bt=/^(?:GET|HEAD)$/,Yt=/^\/\//,Mt={},At={},Pt="*/".concat("*"),qt=i.createElement("a");function Et(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,a=t.toLowerCase().match(P)||[];if(f(n))for(;i=a[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function jt(e,t,n,i){var o={},a=e===At;function s(r){var l;return o[r]=!0,x.each(e[r]||[],function(e,r){var c=r(t,n,i);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),l}return s(t.dataTypes[0])||!o["*"]&&s("*")}function Wt(e,t){var n,i,o=x.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&x.extend(!0,e,i),e}qt.href=bt.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Wt(Wt(e,x.ajaxSettings),t):Wt(x.ajaxSettings,e)},ajaxPrefilter:Et(Mt),ajaxTransport:Et(At),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var o,a,s,r,l,c,d,u,p,h,m=x.ajaxSetup({},n),f=m.context||m,g=m.context&&(f.nodeType||f.jquery)?x(f):x.event,v=x.Deferred(),y=x.Callbacks("once memory"),b=m.statusCode||{},k={},w={},$="canceled",G={readyState:0,getResponseHeader:function(e){var t;if(d){if(!r)for(r={};t=Dt.exec(s);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return d?s:null},setRequestHeader:function(e,t){return null==d&&(e=w[e.toLowerCase()]=w[e.toLowerCase()]||e,k[e]=t),this},overrideMimeType:function(e){return null==d&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(d)G.always(e[G.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||$;return o&&o.abort(t),C(0,t),this}};if(v.promise(G),m.url=((t||m.url||bt.href)+"").replace(Yt,bt.protocol+"//"),m.type=n.method||n.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(P)||[""],null==m.crossDomain){c=i.createElement("a");try{c.href=m.url,c.href=c.href,m.crossDomain=qt.protocol+"//"+qt.host!=c.protocol+"//"+c.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=x.param(m.data,m.traditional)),jt(Mt,m,n,G),d)return G;for(p in(u=x.event&&m.global)&&0==x.active++&&x.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Bt.test(m.type),a=m.url.replace(Tt,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(St,"+")):(h=m.url.slice(a.length),m.data&&(m.processData||"string"==typeof m.data)&&(a+=(kt.test(a)?"&":"?")+m.data,delete m.data),!1===m.cache&&(a=a.replace(Xt,"$1"),h=(kt.test(a)?"&":"?")+"_="+xt+++h),m.url=a+h),m.ifModified&&(x.lastModified[a]&&G.setRequestHeader("If-Modified-Since",x.lastModified[a]),x.etag[a]&&G.setRequestHeader("If-None-Match",x.etag[a])),(m.data&&m.hasContent&&!1!==m.contentType||n.contentType)&&G.setRequestHeader("Content-Type",m.contentType),G.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Pt+"; q=0.01":""):m.accepts["*"]),m.headers)G.setRequestHeader(p,m.headers[p]);if(m.beforeSend&&(!1===m.beforeSend.call(f,G,m)||d))return G.abort();if($="abort",y.add(m.complete),G.done(m.success),G.fail(m.error),o=jt(At,m,n,G)){if(G.readyState=1,u&&g.trigger("ajaxSend",[G,m]),d)return G;m.async&&m.timeout>0&&(l=e.setTimeout(function(){G.abort("timeout")},m.timeout));try{d=!1,o.send(k,C)}catch(e){if(d)throw e;C(-1,e)}}else C(-1,"No Transport");function C(t,n,i,r){var c,p,h,k,w,$=n;d||(d=!0,l&&e.clearTimeout(l),o=void 0,s=r||"",G.readyState=t>0?4:0,c=t>=200&&t<300||304===t,i&&(k=function(e,t,n){for(var i,o,a,s,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in r)if(r[o]&&r[o].test(i)){l.unshift(o);break}if(l[0]in n)a=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){a=o;break}s||(s=o)}a=a||s}if(a)return a!==l[0]&&l.unshift(a),n[a]}(m,G,i)),k=function(e,t,n,i){var o,a,s,r,l,c={},d=e.dataTypes.slice();if(d[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(a=d.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=d.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(s=c[l+" "+a]||c["* "+a]))for(o in c)if((r=o.split(" "))[1]===a&&(s=c[l+" "+r[0]]||c["* "+r[0]])){!0===s?s=c[o]:!0!==c[o]&&(a=r[0],d.unshift(r[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(m,k,G,c),c?(m.ifModified&&((w=G.getResponseHeader("Last-Modified"))&&(x.lastModified[a]=w),(w=G.getResponseHeader("etag"))&&(x.etag[a]=w)),204===t||"HEAD"===m.type?$="nocontent":304===t?$="notmodified":($=k.state,p=k.data,c=!(h=k.error))):(h=$,!t&&$||($="error",t<0&&(t=0))),G.status=t,G.statusText=(n||$)+"",c?v.resolveWith(f,[p,$,G]):v.rejectWith(f,[G,$,h]),G.statusCode(b),b=void 0,u&&g.trigger(c?"ajaxSuccess":"ajaxError",[G,m,c?p:h]),y.fireWith(f,[G,$]),u&&(g.trigger("ajaxComplete",[G,m]),--x.active||x.event.trigger("ajaxStop")))}return G},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,void 0,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,i,o){return f(n)&&(o=o||i,i=n,n=void 0),x.ajax(x.extend({url:e,type:t,dataType:o,data:n,success:i},x.isPlainObject(e)&&e))}}),x._evalUrl=function(e){return x.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},x.fn.extend({wrapAll:function(e){var t;return this[0]&&(f(e)&&(e=e.call(this[0])),t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return f(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=f(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){x(this).replaceWith(this.childNodes)}),this}}),x.expr.pseudos.hidden=function(e){return!x.expr.pseudos.visible(e)},x.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ht={0:200,1223:204},It=x.ajaxSettings.xhr();m.cors=!!It&&"withCredentials"in It,m.ajax=It=!!It,x.ajaxTransport(function(t){var n,i;if(m.cors||It&&!t.crossDomain)return{send:function(o,a){var s,r=t.xhr();if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)r[s]=t.xhrFields[s];for(s in t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)r.setRequestHeader(s,o[s]);n=function(e){return function(){n&&(n=i=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?a(0,"error"):a(r.status,r.statusText):a(Ht[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=n(),i=r.onerror=r.ontimeout=n("error"),void 0!==r.onabort?r.onabort=i:r.onreadystatechange=function(){4===r.readyState&&e.setTimeout(function(){n&&i()})},n=n("abort");try{r.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),x.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){var t,n;if(e.crossDomain)return{send:function(o,a){t=x("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&a("error"===e.type?404:200,e.type)}),i.head.appendChild(t[0])},abort:function(){n&&n()}}});var Nt,zt=[],Ft=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||x.expando+"_"+xt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,i){var o,a,s,r=!1!==t.jsonp&&(Ft.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ft.test(t.data)&&"data");if(r||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Ft,"$1"+o):!1!==t.jsonp&&(t.url+=(kt.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]},t.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){void 0===a?x(e).removeProp(o):e[o]=a,t[o]&&(t.jsonpCallback=n.jsonpCallback,zt.push(o)),s&&f(a)&&a(s[0]),s=a=void 0}),"script"}),m.createHTMLDocument=((Nt=i.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Nt.childNodes.length),x.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((o=(t=i.implementation.createHTMLDocument("")).createElement("base")).href=i.location.href,t.head.appendChild(o)):t=i),s=!n&&[],(a=T.exec(e))?[t.createElement(a[1])]:(a=ye([e],t,s),s&&s.length&&x(s).remove(),x.merge([],a.childNodes)));var o,a,s},x.fn.load=function(e,t,n){var i,o,a,s=this,r=e.indexOf(" ");return r>-1&&(i=ht(e.slice(r)),e=e.slice(0,r)),f(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),s.length>0&&x.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){a=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,a||[e.responseText,t,e])})}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.expr.pseudos.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length},x.offset={setOffset:function(e,t,n){var i,o,a,s,r,l,c=x.css(e,"position"),d=x(e),u={};"static"===c&&(e.style.position="relative"),r=d.offset(),a=x.css(e,"top"),l=x.css(e,"left"),("absolute"===c||"fixed"===c)&&(a+l).indexOf("auto")>-1?(s=(i=d.position()).top,o=i.left):(s=parseFloat(a)||0,o=parseFloat(l)||0),f(t)&&(t=t.call(e,n,x.extend({},r))),null!=t.top&&(u.top=t.top-r.top+s),null!=t.left&&(u.left=t.left-r.left+o),"using"in t?t.using.call(e,u):d.css(u)}},x.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],o={top:0,left:0};if("fixed"===x.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===x.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((o=x(e).offset()).top+=x.css(e,"borderTopWidth",!0),o.left+=x.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-x.css(i,"marginTop",!0),left:t.left-o.left-x.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===x.css(e,"position");)e=e.offsetParent;return e||be})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;x.fn[e]=function(i){return N(this,function(e,i,o){var a;if(g(e)?a=e:9===e.nodeType&&(a=e.defaultView),void 0===o)return a?a[t]:e[i];a?a.scrollTo(n?a.pageXOffset:o,n?o:a.pageYOffset):e[i]=o},e,i,arguments.length)}}),x.each(["top","left"],function(e,t){x.cssHooks[t]=Ne(m.pixelPosition,function(e,n){if(n)return n=Ie(e,t),je.test(n)?x(e).position()[t]+"px":n})}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){x.fn[i]=function(o,a){var s=arguments.length&&(n||"boolean"!=typeof o),r=n||(!0===o||!0===a?"margin":"border");return N(this,function(t,n,o){var a;return g(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===o?x.css(t,n,r):x.style(t,n,o,r)},t,s?o:void 0,s)}})}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),x.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),x.proxy=function(e,t){var n,i,o;if("string"==typeof t&&(n=e[t],t=e,e=n),f(e))return i=a.call(arguments,2),(o=function(){return e.apply(t||this,i.concat(a.call(arguments)))}).guid=e.guid=e.guid||x.guid++,o},x.holdReady=function(e){e?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=S,x.isFunction=f,x.isWindow=g,x.camelCase=L,x.type=b,x.now=Date.now,x.isNumeric=function(e){var t=x.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return x});var Ot=e.jQuery,Lt=e.$;return x.noConflict=function(t){return e.$===x&&(e.$=Lt),t&&e.jQuery===x&&(e.jQuery=Ot),x},t||(e.jQuery=e.$=x),x}),document.addEventListener("keydown",e=>{console.log(e.key)}),document.addEventListener("mousemove",e=>{mouX=e.pageX-canvas.offsetLeft,mouY=e.pageY-canvas.offsetTop});const inch=canvas.width/36,cm0=canvas.width/81.2,cm=cm0.toFixed(1),hi="hi",greenColor="rgba(133, 255, 102, .042)",redColor="rgba(123, 66, 42, .42)",yellowColor="rgba(237, 240, 57, 0.52)",blueColor="rgba(112, 117, 185, 0.52)",purpleColor="rgba(170, 112, 185, 0.52)",grayColor="rgba(134, 134, 141, 0.24)",hasActivatedColor="rgba(134, 134, 141, 0.6)",dodgepushColor="rgba(146, 148, 42, 0.52)",kickColor="rgba(199, 233, 145, 0.42)";let leafletBackground=new Image;leafletBackground.src="./icons/cursor/bg.jpg";const chargeColor="rgba(124, 56, 39, 0.4)",noColor="rgba(0,0,0,0)",backgroundTtoss=Math.floor(5*Math.random()+1);let bleedingIco=new Image;bleedingIco.src="./icons/Conditions/Bleeding.jpg";let burningIco=new Image;burningIco.src="./icons/Conditions/Burning.jpg";let knockedDownIco=new Image;knockedDownIco.src="./icons/Conditions/knockedDown.jpg";let poisonIco=new Image;poisonIco.src="./icons/Conditions/Poison.jpg";let snaredIco=new Image;snaredIco.src="./icons/Conditions/Snared.jpg";let degree=Math.PI/180,healCursor=0,hasConditions=e=>!!(e.isBleeding||e.isBurning||e.isDiseased||e.isKnockedDown||e.isPoisoned||e.isSnared),fontz=new FontFace("IM Fell English","url(https://fonts.googleapis.com/css?family=Merienda)");showLeaflet=!0;let movementHistory=[];const savedGameState=[];let switcher,wrath,receiver,Gamer1,Gamer2,Gamer,otherGamer,teamz,neSpotx,neSpoty,counter=0,ruler=!1,rulerDopplers=[];console.log(rulerDopplers);let kolor,rdLength=0,mouse_position=[],canvas_element=$("#terrains_layer"),konvas=canvas_element.get(0).getContext("2d"),puddles=[];const td=[];let filtered_td=[];fontz.load().then(e=>{document.fonts.add(e)});const tp=[{dir:["./icons/Terrains/forest01.svg","./icons/Terrains/forest02.svg","./icons/Terrains/forest03.svg"],size:[5,6,3.6,4.8],kind:"forest",description:["forest",'-2/2" movement',"gives cover"]},{dir:["./icons/Terrains/fastGround01.svg","./icons/Terrains/fastGround02.svg","./icons/Terrains/fastGround03.svg"],size:[3,3,3,3],kind:"fastGround",description:["fast ground",'+2/2" movement']},{dir:["./icons/Terrains/roughGround01.svg","./icons/Terrains/roughGround02.svg","./icons/Terrains/roughGround03.svg"],size:[3.5,4.5,3,3.5],kind:"roughGround",description:["rough ground",'-2/2" movement']},{dir:["./icons/Terrains/wall01.svg","./icons/Terrains/wall01.svg","./icons/Terrains/wall01.svg"],size:[5,3.5,1,2],kind:"wall",description:["wall","gives cover"]},{dir:["./icons/Terrains/obstacle01.svg","./icons/Terrains/obstacle02.svg","./icons/Terrains/obstacle03.svg"],size:[3,4,3,4],kind:"obstacle",description:["obstacle","gives cover"]}],coords=[[108,295],[304,295],[540,295],[776,295],[988,295],[108,500],[304,500],[540,500],[776,500],[988,500],[108,785],[304,785],[540,785],[776,785],[988,785]];let diceRolledForDisplay=[],$playBookTop=[],$playBookCircle=[],$teamplays=[];var playBookWrap;function plajBookWraz(){return $(".playbookWrap").parent().empty().off(),playBookWrap={noWrap:[[],[],"noWrapTop","noWrapBottom"],firstWrap:[[],[],"firstWrapTop","firstWrapBottom"],secondWrap:[[],[],"secondWrapTop","secondWrapBottom"],thirdWrap:[[],[],"thirdWrapTop","thirdWrapBottom"],fourthWrap:[[],[],"fourthWrapTop","fourthWrapBottom"],fifthWrap:[[],[],"fifthWrapTop","fifthWrapBottom"],sixthWrap:[[],[],"sixthWrapTop","sixthWrapBottom"],seventhWrap:[[],[],"seventhWrapTop","seventhWrapBottom"]}}let message;function collisionBouncer(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(e.name!=i.name&&distance(e.posX,e.posY,i.posX,i.posY)<=e.baseRadius+i.baseRadius){let t=e.posX<i.posX?-e.baseRadius:e.baseRadius,n=e.posY<i.posY?-e.baseRadius:e.baseRadius,o=i.posX,a=i.posY;e.posX=e.posX+t/20,e.posY=e.posY+n/20,i.posX=o,i.posY=a}else if(distance(e.posX,e.posY,Gamer.gp.x,Gamer.gp.y)<=e.baseRadius+2.5*cm){let t=e.posX<Gamer.gp.x?-e.baseRadius:e.baseRadius,n=e.posY<Gamer.gp.y?-e.baseRadius:e.baseRadius,o=i.posX,a=i.posY;e.posX=e.posX+t/20,e.posY=e.posY+n/20,i.posX=o,i.posY=a}else if(distance(e.posX,e.posY,otherGamer.gp.x,otherGamer.gp.y)<=e.baseRadius+2.5*cm){let t=e.posX<otherGamer.gp.x?-e.baseRadius:e.baseRadius,n=e.posY<otherGamer.gp.y?-e.baseRadius:e.baseRadius;e.posX=e.posX+t/20,e.posY=e.posY+n/20}else e.oldX=e.posX,e.oldY=e.posY}}function adminToolz(e,t,n,i){$("canvas").on("mousedown",function(e){0==e.button&&t.myDown(e)}),$("canvas").on("mousemove",function(e){t.squaddieDeploy(e,n,i)}),$("canvas").on("mouseup",function(e){t.myUp(e)})}plajBookWraz();const isInMelee=(e,t)=>distance(e.posX,e.posY,t.posX,t.posY)<=e.meleeRadius+t.baseRadius,angle=(e,t,n,i)=>{var o=i-t,a=n-e;return Math.atan2(o,a)};class Player{constructor(e,t,n,i,o,a,s,r,l,c,d,u,p,h,m,f,g,v,y){switch(this.sprint=e,this.run=t,this.runPaid=!1,this.charge=n,this.Acharge=n,this.isCharging=!1,this.wasCharging=!1,this.doICollide,this.tac=i,this.Atac=i,this.meleeZone=u,this.AmeleeZone=u,this.isEngaged=!1,this.playBook=g,this.kick=o,this.Akick=o,this.kickDist=a,this.AkickDist=a,this.hasBall=!1,this.isKicking=!1,this.kickReRoll=0,this.def=s,this.Adef=s,this.arm=r,this.Aarm=r,this.theGuild=y,this.infGen=l,this.infMin=c,this.infMax=d,this.hp=p,this.hpMin=p,this.icySponge=v,this.heal=0,this.baseSize=h,this.baseSize){case 1:this.baseRadius=1.2*cm;break;case 2:this.baseRadius=1.6*cm;break;default:this.baseRadius=2.2*cm}this.name=f,this.pictureSource=m,this.posX,this.posY,this.dragOk=!1,this.baseRadius,this.meleeRadius,this.meleeColor,this.moveAura=!1,this.oldX=this.posX,this.oldY=this.posY,this.isActivating=!1,this.hasActivated=!1,this.isMoving=!1,this.hasMoved=!1,this.isAttacking=!1,this.hasAttacked=!1,this.isKicking=!1,this.hasKicked=!1,this.hasSnapped=!1,this.hasDropped=!1,this.canSnap=!1,this.isPushed=!1,this.isDodging=!1,this.dodgeDistance=0,this.pushDistance=0,this.dopplerColor,this.isBleeding=!1,this.isBurning=!1,this.isDiseased=!1,this.isKnockedDown=!1,this.isPoisoned=!1,this.isSnared=!1,this.removedConditions=0,this.isTakenOut=!1,this.bonusTime=!1,this.pressedAbutton=!1,this.remainingRun=this.run*inch+this.baseRadius,this.remainingSprint=this.sprint*inch+this.baseRadius,this.counterForAttack=[],this.willCounter,this.defensiveStance=0,this.inCover=!1,this.inFastGround=!1,this.inRoughGround=!1,this.isGliding=!1,this.shouldntBeHere=0}drawConditions(e,t,n=this.baseRadius){let i=Math.PI/180;pcl.save(),pcl.translate(this.posX,this.posY),pcl.rotate(-19*e*i+-45*i),pcl.beginPath(),pcl.arc(0,n,4,2*Math.PI,0),pcl.clip(),pcl.strokeStyle=this.theGuild.color,pcl.lineWidth=1,pcl.fill(),pcl.drawImage(t,-6,n-3,16,16),pcl.stroke(),pcl.restore()}drawPlayerIcon(e=this.posX,t=this.posY,n=1,i=this.meleeColor){let o=this.baseRadius;this.meleeRadius=o+this.meleeZone*inch;const a=new Image;a.src=this.pictureSource,pcl.lineWidth=1,ctx.lineWidth=1,ctx.beginPath(),ctx.globalAlpha=n,aurora(e,t,this.baseRadius,e,t,this.meleeRadius,i,i),ctx.closePath(),ctx.strokeStyle=this.theGuild.color,ctx.stroke(),pcl.beginPath(),pcl.arc(e,t,o,0,2*Math.PI,!0),pcl.closePath(),pcl.save(),pcl.clip(),pcl.beginPath(),pcl.drawImage(a,e-o,t-o,2*o,2*o),pcl.beginPath(),pcl.lineWidth=1,pcl.restore();for(let n=0;n<7;n++)n%2==0?(pcl.beginPath(),pcl.lineWidth=3,pcl.strokeStyle=this.hasBall?"black":this.theGuild.color,pcl.arc(e,t,o,n,n+1,!1),pcl.stroke()):(pcl.beginPath(),pcl.arc(e,t,o,n,n+1,!1),pcl.lineWidth=3,pcl.strokeStyle=this.hasBall?"white":this.theGuild.color,pcl.stroke());for(let e=0;e<this.infMin;e++)pcl.save(),pcl.translate(this.posX,this.posY),pcl.rotate(19*(1+e)*degree+45*degree),pcl.beginPath(),pcl.fillStyle="yellow",pcl.lineWidth=1.6,pcl.arc(0,o,3,2*Math.PI,0),pcl.fill(),pcl.stroke(),pcl.restore();this.isBleeding&&this.drawConditions(1,bleedingIco,o),this.isBurning&&this.drawConditions(2,burningIco,o),this.isKnockedDown&&this.drawConditions(3,knockedDownIco,o),this.isPoisoned&&this.drawConditions(4,poisonIco,o),this.isSnared&&this.drawConditions(5,snaredIco,o),this.isDiseased&&(pcl.save(),pcl.translate(this.posX,this.posY),pcl.rotate(-114*degree+-45*degree),pcl.beginPath(),pcl.fillStyle="rgb(143, 236, 22)",pcl.lineWidth=1.6,pcl.arc(0,o,3,2*Math.PI,0),pcl.fill(),pcl.stroke(),pcl.restore()),pcl.beginPath(),pcl.lineWidth=1,pcl.font="900 24px IM Fell English ",pcl.fillStyle=this.hpMin===this.hp?"rgb(133, 176, 233)":this.hpMin>this.icySponge?"rgb(247, 201, 0)":"rgb(204, 75, 1)",pcl.strokeStyle="rgba(79, 82, 78, 0.753)",pcl.textAlign="center",pcl.strokeText(this.hpMin,this.posX,this.posY+2+o),pcl.fillText(this.hpMin,this.posX,this.posY+2+o),pcl.closePath()}myMove(e){this.dragOk&&(this.posX=mouX-canvas.offsetLeft,this.posY=mouY-canvas.offsetTop,this.meleeColor=yellowColor)}squaddieDeploy(e,t,n){let i=t.deployment;this.dragOk&&"deployment"===n&&mouX>0+this.baseRadius&&mouY>i[0]+(i[0]<10*inch?-this.baseRadius:this.baseRadius)&&mouX<canvas.width-this.baseRadius&&mouY<i[1]-this.baseRadius&&(this.posX=mouX,this.posY=mouY,this.meleeColor=yellowColor),"comeback"===n&&this.dragOk&&(i[0]<=10*inch&&Boolean(Boolean(mouY<=10*inch&&mouX<=this.baseRadius+5||mouY<=10*inch&&mouX>=canvas.width-this.baseRadius-5)||mouY<=this.baseRadius+5)?(this.posX=mouX,this.posY=mouY,this.meleeColor=yellowColor):Boolean(Boolean(mouY>=canvas.height-10*inch-5+this.baseRadius&&mouX<=this.baseRadius+5||mouY>=canvas.width-10*inch-5+this.baseRadius&&mouX>=canvas.width-this.baseRadius-5)||mouY>=canvas.width-this.baseRadius-5)&&(this.posX=mouX,this.posY=mouY,this.meleeColor=yellowColor))}myDown(e){distance(this.posX,this.posY,mouX,mouY)<this.baseRadius&&(this.dragOk=!0)}myUp(e){this.dragOk=!1}kickAura(){this.isKicking&&(ctx.beginPath(),aurora(this.posX,this.posY,this.baseRadius,this.posX,this.posY,this.kickDist*inch+this.baseRadius,kickColor,yellowColor),ctx.closePath())}moveAuraf(){(this.moveAura&&!this.hasMoved||this.isCharging&&!this.hasMoved)&&(ctx.beginPath(),aurora(this.posX,this.posY,this.baseRadius,this.posX,this.posY,this.remainingSprint>0?this.remainingSprint:0,this.isCharging?noColor:yellowColor,this.isCharging?noColor:blueColor),ctx.closePath(),(this.infMin>0||this.runPaid)&&(ctx.beginPath(),aurora(this.posX,this.posY,this.baseRadius,this.posX,this.posY,this.remainingRun,yellowColor,this.isCharging?chargeColor:purpleColor),ctx.closePath()))}isDodgingAura(){this.isDodging&&(ctx.beginPath(),aurora(this.posX,this.posY,this.baseRadius,this.posX,this.posY,this.baseRadius+this.dodgeDistance,dodgepushColor,yellowColor),ctx.closePath())}isPushedAura(){this.isPushed&&(ctx.beginPath(),aurora(this.posX,this.posY,this.baseRadius,this.posX,this.posY,this.baseRadius+this.pushDistance,dodgepushColor,yellowColor),ctx.closePath())}playerStatus(){this.hasActivated&&(this.oldX=this.posX,this.oldY=this.posY,pcl.beginPath(),pcl.arc(this.posX,this.posY,this.baseRadius,0,2*Math.PI,!1),pcl.fillStyle=hasActivatedColor,pcl.fill())}doppler(e,t,n,i=this.posX,o=this.posY){if((this.isCharging&&!this.wasCharging||this.moveAura&&!this.wasCharging||this.isDodging||this.isPushed||ruler&&this.isActivating)&&(this.drawPlayerIcon(e,t,n,this.dopplerColor),ctx.beginPath(),ctx.moveTo(i,o),ctx.lineTo(e,t),ctx.lineWidth=2*this.baseRadius,ctx.stroke(),ctx.fill(),ctx.closePath(),distance(e,t,i,o)/inch>3)){ctx.save(),ctx.translate(e,t),ctx.rotate(angle(e,t,i,o)),ctx.font="900 24px IM Fell English ",ctx.fillStyle="rgba(255,255,255,.6)",ctx.strokeStyle="rgba(80,80,80,.6)",ctx.textAlign="center",ctx.lineWidth=15;let n=distance(e,t,i,o)/inch;ctx.strokeText("<-- "+parseFloat(n).toFixed(1)+'" --\x3e',n/2*inch,0),ctx.fillText("<-- "+parseFloat(n).toFixed(1)+'" --\x3e',n/2*inch,0),ctx.closePath(),ctx.restore()}}dropper(){this.hasMoved||(distance(this.posX,this.posY,mouX,mouY)>this.remainingSprint-this.baseRadius&&!this.runPaid&&!this.isCharging&&!this.wasCharging&&(this.infMin-=1,this.runPaid=!0),this.moveAura=!0,this.isMoving=!0,anime(this,teamz,otherGamer,{mode:this.isCharging?"charging":""}))}pushSquaddie(e){this.pushDistance=e*inch,this.isPushed&&(this.doppler(mouX,mouY,.5),$("canvas").on("click",()=>{distance(this.posX,this.posY,mouX,mouY)<=this.pushDistance+2/this.baseRadius&&this.isPushed&&anime(this,teamz,otherGamer,{ox:mouX,oy:mouY})}))}dodgeSquaddie(e){this.dodgeDistance=e*inch,this.isDodging&&(this.doppler(mouX,mouY,.5),$("canvas").on("click",()=>{distance(this.posX,this.posY,mouX,mouY)<=this.dodgeDistance+2/this.baseRadius&&this.isDodging&&(anime(this,teamz,otherGamer,{ox:mouX,oy:mouY}),console.log(this.name))}))}}function aurora(e=0,t=0,n=0,i=0,o=0,a=0,s="rgba(255,255,255,0)",r="rgba(255,255,255,0)"){if(e>0){let l=ctx.createRadialGradient(e,t,n,i,o,a);l.addColorStop(1,s),l.addColorStop(a<5*inch?.9:.95,r),l.addColorStop(a<5*inch?.6:.85,"rgba(255,255,255,0)"),ctx.fillStyle=l,ctx.arc(e,t,a,0,2*Math.PI,!1),ctx.fill()}}let diceRoller=(e,t,n,i=n,o)=>{let a="kick"===o?n.kick+(n.bonusTime||i.bonusTime?1:0)-t.squaddies.filter(e=>distance(n.posX,n.posY,e.posX,e.posY)<=e.meleeRadius+n.baseRadius).length:"parting blow"===o?n.tac+2:n.tac+(i.inCover?-1:0)+(n.wasCharging?4:0)+(n.bonusTime?1:0)+e.squaddies.filter(e=>e.name!==n.name).filter(e=>distance(e.posX,e.posY,i.posX,i.posY)<=e.meleeRadius+i.baseRadius).length-t.squaddies.filter(e=>e.name!==i.name).filter(e=>distance(n.posX,n.posY,e.posX,e.posY)<=e.meleeRadius+n.baseRadius).length,s=[],r=0;do{s.push(Math.ceil(6*Math.random())),r++}while(r<a);return n.bonusTime=!1,console.log("rolled: ",...s),s};function diceRolled(e,t,n,i=0){e.forEach(e=>{switch(e){case 1:diceRolledForDisplay.push(`<div class="die dice-1" style="background-color:${e>=t?n:"white"}">\n                        <div class="die-1 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                    </div>`);break;case 2:diceRolledForDisplay.push(`<div class="die dice-2" style="background-color:${e>=t?n:"white"}">\n                        <div class="die-1 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-2 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        </div>`);break;case 3:diceRolledForDisplay.push(`<div class="die dice-3" style="background-color:${e>=t?n:"white"}">\n                        <div class="die-1 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-2 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-3 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                    </div>`);break;case 4:diceRolledForDisplay.push(`<div class="die dice-4" style="background-color:${e>=t?n:"white"}">\n                        <div class="die-1 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-2 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-3 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-4 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                    </div>`);break;case 5:diceRolledForDisplay.push(`<div class="die dice-5" style="background-color:${e>=t?n:"white"}">\n                        <div class="die-1 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-2 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-3 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-4 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                        <div class="die-5 die-eye" style="background-color:${e>=t?"white":"rgb(114, 107, 107)"}"></div>\n                    </div>`);break;case 6:diceRolledForDisplay.push(`<div class="die dice-6" style="background-color:${n}">\n                        <div class="die-1 die-eye" style=" background-color:white "></div>\n                        <div class="die-2 die-eye" style=" background-color:white "></div>\n                        <div class="die-3 die-eye" style=" background-color:white "></div>\n                        <div class="die-4 die-eye" style=" background-color:white "></div>\n                        <div class="die-5 die-eye" style=" background-color:white "></div>\n                        <div class="die-6 die-eye" style=" background-color:white "></div>\n                    </div>`)}})}function actionButtons(e,t,n=t.guild.color){let i=e.hasBall&&counter>4?`<div id='dropBall${e.name}' style='border-color:${n}'>drop ball</div>`:"",o=e.hasBall&&e.infMin>0&&5===counter||2===counter?`<div id='kick${e.name}' style='border-color:${n}'>Kick</div>`:"",a=e.infMin>1&&!e.isMoving&&!e.hasMoved&&!e.isEngaged&&counter>4?`<div id='charge${e.name}' style='border-color:${n}'>Charge</div>`:"",s=t.momentum>0&&!e.bonusTime?`<div id='bonusTime${e.name}' style='border-color:${n}'>Bonus time</div>`:"",r=t.momentum>(e.isDiseased?1:0)&&e.hpMin<e.hp&&e.heal<1&&1!==e.removedConditions?`<div id='healSelf${e.name}' style='border-color:${n}'>heal self</div>`:"",l=e.isKnockedDown?`<div id='forfeitMove${e.name}' style='border-color:${n}'>forfeit move</div>`:"",c=e.removedConditions<1&&1!==e.heal&&t.momentum>(e.isDiseased?1:0)&&(e.isPoisoned||e.isBleeding||e.isKnockedDown||e.isSnared||e.isBurning||e.isDiseased)?`<div id='removeConditions${e.name}' style='border-color:${n}'>remove conditions</div>`:"",d=t.momentum>1&&t.squaddies.filter(e=>e.hpMin<e.hp).filter(t=>t.name!==e.name).filter(t=>distance(t.posX,t.posY,e.posX,e.posY)<=e.baseRadius+t.baseRadius+8*inch).filter(e=>e.heal<1).length>0?`<div id='healAFriend${e.name}' style='border-color:${n}'>heal a friend</div>`:"",u=t.momentum>1&&t.squaddies.filter(e=>e.isBleeding||e.isBurning||e.isDiseased||e.isKnockedDown||e.isPoisoned||e.isSnared).filter(t=>t.name!==e.name).filter(t=>distance(t.posX,t.posY,e.posX,e.posY)<=e.baseRadius+t.baseRadius+8*inch).filter(e=>e.removedConditions<1).filter(e=>e.heal<1).length>0?`<div id='takeAbreather${e.name}' style='border-color:${n}'>take a breather</div>`:"",p=t.momentum>0?`<div class='glide${e.name}' style='border-color:${n}'>Glide</div>`:"",h=0===counter||Boolean(3===counter&&Boolean(Boolean(t.deployment[0]<canvas.height/2&&ball.y>canvas.height/2+ball.ballSize)||Boolean(t.deployment[0]>canvas.height/2&&ball.y<canvas.height/2-ball.ballSize)))?`<div class='giveBallTo${e.name}' style='border-color:${n};'>give ball</div>`:"",m=counter>6||counter>2&&counter<5?`\n    <div class='addInf${e.name}' style='border-color:${n}'>+Influence+</div>\n    <div class='minInf${e.name}' style='border-color:${n}'>-Influence-</div>`:"",f=distance(ball.x,ball.y,e.posX,e.posY)<ball.ballSize+e.baseRadius+1*inch&&ball.isOnGround?`<div id='snapBall${e.name}' style='border-color:${n}'>snap ball</div>`:"",g=1===e.kickReRoll?`<div id='kickReRoll${e.name}' style='border-color:${n}'>re-roll kick</div>`:"",v=`<div id='ruler${e.name}' style='border-color:${n}'>ruler toggle</div>`,y=counter<2?`<div class='passActivation${e.name}' style='border-color:${n}; color:red'>end deployment</div>`:counter<3?`<div class='passActivation${e.name}' style='border-color:${n}; color:red'>end kickoff</div>`:counter<5||counter>6?`<div class='passActivation${e.name}' style='border-color:${n}; color:red'>end allocation</div>`:`<div class='passActivation${e.name}' style='border-color:${n}; color:red'>end activation</div>`,b=5===counter?[i,a,s,r,c,l,d,u,f,p,v]:[];return`\n    ${y}\n    ${h}\n    <div class='leaflet${e.name}' style='border-color:${n}'>toggle card display</div>\n    <div id='undoMove${e.name}' style='border-color:${n}'>undo movement</div>\n    ${m}\n    ${o}\n    ${g}\n    ${b.join("")}\n    `}let appMaker=(e,t)=>{let n=t.guild.color,i=[],o=0;for(let t=0;t<e.hp-(e.hp-e.hpMin);t++)o++,i.push(`<li class='hpli' style='border-color:${n}'>${o}</li>`);for(let t=0;t<e.hp-e.hpMin;t++)o++,i.push(`<li class='hpliMin' style='border-color:${n}'>${o}</li>`);return $(`<div id=appDisplay>            \n    <h1 id='squaddieName' style='border-color:${n}'>${e.name}</h1>\n    <div id='images'>\n    <ul class='hp plajbooks teaMenu dice'>${diceRolledForDisplay.join("")}</ul>\n        <div>\n            <img id='squaddieFace' src=${e.pictureSource} style='border-color:${n}'/>\n        </div>\n\n    </div>\n    <table id='squaddieStats' style="width:100%">\n        <tr>\n            <th colspan="2" style='border-color:${n}'>MOV</th>\n            <th style='border-color:${n}'>TAC</th>\n            <th colspan="2" style='border-color:${n}'>KICK</th>\n            <th style='border-color:${n}'>DEF</th>\n            <th style='border-color:${n}'>ARM</th>\n            <th colspan="2" style='border-color:${n}'>INF</th>\n        </tr>\n        <tr>\n            <td id='squaddieJog'style='border-color:${n}'>${e.sprint}</td>\n            <td id='squaddieSprint'style='border-color:${n}'>${e.run}</td>\n            <td id='squaddieTac'style='border-color:${n}'>${e.tac}</td>\n            <td id='squaddieKickDice'style='border-color:${n}'>${e.kick}</td>\n            <td id='squaddieKickDistance'style='border-color:${n}'>${e.kickDist}</td>\n            <td id='squaddieDeff'style='border-color:${n}'>${e.def}</td>\n            <td id='squaddieArm'style='border-color:${n}'>${e.arm}</td>\n            <td id='squaddieInfGen'style='border-color:${n}'>${e.infGen}</td>\n            <td id='squaddieInfMax'style='border-color:${n}'>${e.infMax}</td>\n        </tr>\n    </table> \n\n<ul class='hp plajbooks teaMenu playbookNodes'>\n    <ul class='playbookWrap pW0'>\n        <ul>${playBookWrap.noWrap[0].join("")}</ul>\n        <ul>${playBookWrap.noWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW1'>\n        <ul>${playBookWrap.firstWrap[0].join("")}</ul>\n        <ul>${playBookWrap.firstWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW2'>\n        <ul>${playBookWrap.secondWrap[0].join("")}</ul>\n        <ul>${playBookWrap.secondWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW3'>\n        <ul>${playBookWrap.thirdWrap[0].join("")}</ul>\n        <ul>${playBookWrap.thirdWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW4'>\n        <ul>${playBookWrap.fourthWrap[0].join("")}</ul>\n        <ul>${playBookWrap.fourthWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW5'>\n        <ul>${playBookWrap.fifthWrap[0].join("")}</ul>\n        <ul>${playBookWrap.fifthWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW6'>\n        <ul>${playBookWrap.sixthWrap[0].join("")}</ul>\n        <ul>${playBookWrap.sixthWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW7'>\n        <ul>${playBookWrap.seventhWrap[0].join("")}</ul>\n        <ul>${playBookWrap.seventhWrap[1].join("")}</ul>\n    </ul>\n    <ul class='playbookWrap pW8'>\n        <ul>${$teamplays.join("")}</ul>\n    </ul>\n</ul>\n\n    <div id='actionButtons'>\n    ${actionButtons(e,t,n)}\n    </div>\n    \n    <ul class="hp pool">\n    ${i.join("")}\n    </ul>\n    <p class='message'>${message}</p>\n    </div>`)};function counterAttackDialogBox(e,t){const n=!t.counterForAttack.includes(e.name)&&!t.knockedDown&&otherGamer.momentum>0?`            <button \n             id='opt1${t.name}' \n             class='opt1'\n             style = "\n                border:2px solid ${t.theGuild.color};\n                ">  counter<br>attack!\n            </button>`:"",i=!t.counterForAttack.includes(e.name)&&!t.knockedDown&&otherGamer.momentum>0?`            <button \n             id='opt2${t.name}' \n             class='opt2'\n             style = "\n                border:2px solid ${t.theGuild.color};\n            ">not <br> yet</button>`:"",o=`            <button \n             id='opt3${t.name}' \n             class='opt3'\n             style = "\n                border:2px solid ${t.theGuild.color};\n            ">don't<br>bother</button>`,a=!t.counterForAttack.includes(e.name)&&!t.knockedDown&&otherGamer.momentum>1?`            <button\n            id='opt4${t.name}'\n            class='opt4'\n            style= "\n                border:2px solid ${t.theGuild.color};\n            ">bonus<br>counter</button>`:"",s=Boolean(e.isCharging||e.wasCharging)&&otherGamer.momentum>0?`            <button\n            id='opt5${t.name}'\n            class='opt5'\n            style= "\n                border:2px solid ${t.theGuild.color};\n            ">defensive<br>stance</button>`:"",r=!t.counterForAttack.includes(e.name)&&Boolean(e.isCharging||e.wasCharging)&&!t.isKnockedDown&&otherGamer.momentum>1?`            <button\n            id='opt6${t.name}'\n            class='opt6'\n            style= "\n                border:2px solid ${t.theGuild.color};\n            ">defensive<br>counter</button>`:"",l=!t.counterForAttack.includes(e.name)&&Boolean(e.isCharging||e.wasCharging)&&!t.isKnocekdDown&&otherGamer.momentum>2?`            <button\n            id='opt7${t.name}'\n            class='opt7'\n            style= "\n                border:2px solid ${t.theGuild.color};\n            ">bonus<br>defensive<br>counter</button>`:"";$("body").append(`\n    <div \n        id='counterbox${t.name}' \n        class='counterbox'\n        style=" \n        top:${t.posY-50}px;\n        left:${t.posX-100}px;\n        border:3px solid ${t.theGuild.color};\n        ">\n        ${n}\n        ${i}\n        ${o}\n        ${a}\n        ${s}\n        ${r}\n        ${l}\n\n\n\n    </div>`)}function healFunction(e,t,n,i,o){e.heal+=o,e.hpMin+=n,e.hpMin=e.hpMin>e.hp?e.hp:e.hpMin,t.momentum-=i}function removeConditionsFuncion(e,t,n,i){e.removedConditions+=i,e.isBleeding=!1,e.isKnockedDown&&(e.isKnockedDown=!1,e.def+=1,e.hasMoved,e.meleeZone=e.AmeleeZone,e.meleeRadius=e.baseRadius+e.meleeZone*inch),e.isBurning=!1,e.isPoisoned=!1,e.isDiseased=!1,e.isSnared=!1,t.momentum-=n}function knockedDown(e,t){e.isKnockedDown||(e.isKnockedDown=!0,e.isKnockedDown&&(e.meleeZone=0,e.meleeRadius=0,e.def-=1,e.hasBall&&(e.hasBall=!1,t.isOnGround=!0,scatterRandomiser(e.posX,e.posY,!1,e))))}function snare(e){e.isSnared||(e.isSnared=!0,e.remainingRun-=2*inch,e.remainingSprint-=2*inch,e.def-=1)}function burn(e){e.isBurning||(e.isBurning=!0,e.remainingRun-=2*inch,e.remainingSprint-=2*inch)}function diseaseSpread(e,t){}function burning(){}function poisoned(){}function snared(){}function diseased(){}function bleeding(){}function playbookStitcher(e,t,n,i){if(0===e.playBook[t][0].length)n[0].push("<ul class='playBookNull activeOptions'></ul>");else if(0!==e.playBook[t][0].length){let o=e.playBook[t][0][0],a="attack"===i?e.playBook[t][0][1]:0,s="parting blow"!==i?e.playBook[t][0][2]:0,r="parting blow"!==i?e.playBook[t][0][3]:0,l=e.playBook[t][0][4],c=e.playBook[t][0][5],d=0===o?"":o+"<br>",u=0===s?"":s>1?"<br><<":"<br><",p=3===r?">>>":2===r?">>":1===r?">":"",h=0===a?"white":e.theGuild.color,m=`${0===c?"":"KD<br>"}${0===l?"":"T<br>"}${d}${u}${p}`;let f=Boolean(o+a+s+r+l+c>0)?`<li class='plajBookTopCell ${n[2]} activeOptions' \n                        data-dmg=${o} data-mom=${a} data-ddge=${s} data-psh=${r} data-tackle=${l} data-kd=${c}\n                        style="background-color:${h}; color:${a?"white":"black"}">${m}</li>`:"<ul class='playBookNull'></ul>";n[0].push(f)}let o=e.playBook[t][1][0],a="attack"===i?e.playBook[t][1][1]:0,s="parting blow"!==i?e.playBook[t][1][2]:0,r="parting blow"!==i?e.playBook[t][1][3]:0,l=e.playBook[t][1][4],c=e.playBook[t][1][5],d=0===o?"":o+"<br>",u=0===s?"":s>1?"<br><<":"<br><",p=3===r?">>>":2===r?">>":1===r?">":"",h=0===a?"white":e.theGuild.color,m=`${0===c?"":"KD<br>"}${0===l?"":"T<br>"}${d}${u}${p}`;let f=Boolean(o+a+s+r+l+c>0)?`<li class='plajBookCell ${n[3]} activeOptions' \n                                data-dmg=${o} data-mom=${a} data-ddge=${s} data-psh=${r} data-tackle=${l} data-kd=${c}\n                                style="background-color:${h}; color:${a?"white":"black"}">${m}</li>`:"<ul class='playBookNull'></ul>";n[1].push(f),$("#app").empty().append(appMaker(e,Gamer))}function buttonStitching(e,t,n,i,o,a,s){for(let r=2;r<4;r++)$(`.${e[r]}`).each(function(){$(this).on("click",function(){e[0]=[],e[1]=[];let r=Number($(this).data("dmg")),l=Number($(this).data("ddge")),c=Number($(this).data("psh")),d=Number($(this).data("tackle")),u=Number($(this).data("kd"));("attack"===a||"counterattack"===a||n.willCounter&&Boolean(l>0||c>0))&&(l>0&&(t.isDodging=!0,wrath=n,receiver=t,t.dodgeSquaddie(l,teamz,n)),c>0&&(n.isPushed=!0,wrath=n,receiver=t,n.pushSquaddie(c,teamz,n))),d>0&&n.hasBall&&(i.isOnGround||(n.hasBall=!1,t.hasBall=!0,i.x=t.posX,i.y=t.posY)),1!==u||n.isKnockedDown||(knockedDown(n,i),n.willCounter=!1),"parting blow"===a&&s(),n.hasMoved="parting blow"===a&&Number($(this).data("kd"))>0||n.hasMoved,o.momentum+=Number($(this).data("mom")),n.hpMin-=r,Number($(this).data("dmg")),t.wasCharging=!1,t.bonusTime=!1,$(this).parent().parent().empty().off(),$("#app").find("#actionButtons").empty().append(actionButtons(t,o,o.guild.color)),n.willCounter&&l<1&&c<1&&$("#app").find(".activeOptions").length<1&&distance(t.posX,t.posY,n.posX,n.posY)<=n.meleeRadius+t.baseRadius&&(waaar(otherGamer,o,n,t,"counterattack"),n.willCounter=!1)})})}function waaar(e,t,n,i,o="attack",a){let s=i;if($("#app").find(".activeOptions").length<1&&"parting blow"===o||Boolean("counterattack"===o&&distance(n.posX,n.posY,s.posX,s.posY)<=n.meleeRadius+s.baseRadius)||n.infMin>0&&n.isActivating&&!n.isKnockedDown&&distance(n.posX,n.posY,s.posX,s.posY)<=n.meleeRadius+s.baseRadius&&!s.willCounter){console.log(),(n.isDodging||n.isPushed||s.isDodging||s.isPushed)&&(n.isPushed=!1,s.isPushed=!1,n.isDodging=!1,s.isDodging=!1),(n.isMoving||"charge"===o)&&(n.isMoving=!1,n.hasMoved=!0),movementHistory=[],"attack"!==o&&"charge"!==o||(plajBookWraz(),n.hasAttacked=!0,n.infMin-=n.wasCharging?2:1,$playBookCircle=[],$playBookTop=[]);let i=s.def+s.defensiveStance,r=diceRoller(e,t,n,s,o),l=r.filter(e=>e>=i).length-s.arm;if(diceRolledForDisplay=[],diceRolled(r,i,e.guild.color,s.arm),s.defensiveStance=0,message=`now you can see how succesful ${n.name} attack was, and you can choose direct consequences. Press escape to cancel pushes or doges if waiting for counterattack.`,l<1)playBookWrap.noWrap[0].push("<li class='busted'>You missed it all!</li>"),$("#app").empty(),$("#app").append(appMaker(n,e)),$(".busted").on("click",()=>{playBookWrap.noWrap[0]=[],$(".busted").off(),$("#app").empty(),$("#app").append(appMaker(n,e)),s.willCounter&&distance(n.posX,n.posY,s.posX,s.posY)<=n.baseRadius+s.meleeRadius&&$("#app").find(".activeOptions").length<1&&(console.log(hi,"war rolled for counterattacks"),waaar(t,e,s,n,"counterattack"),s.willCounter=!1)});else{let t=Math.floor(l/n.playBook.length),i=l%n.playBook.length;for(let e=0;e<i;e++)playbookStitcher(n,e,playBookWrap.noWrap,o);for(let e=0;e<n.playBook.length;e++)t>=1&&playbookStitcher(n,e,playBookWrap.firstWrap,o),t>=2&&playbookStitcher(n,e,playBookWrap.secondWrap,o),t>=3&&playbookStitcher(n,e,playBookWrap.thirdWrap,o),t>=4&&playbookStitcher(n,e,playBookWrap.fourthWrap,o),t>=5&&playbookStitcher(n,e,playBookWrap.fifthWrap,o),t>=6&&playbookStitcher(n,e,playBookWrap.sixthWrap,o),t>=7&&playbookStitcher(n,e,playBookWrap.seventhWrap,o);buttonStitching(playBookWrap.noWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.firstWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.secondWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.thirdWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.fourthWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.fifthWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.sixthWrap,n,s,ball,e,o,a),buttonStitching(playBookWrap.seventhWrap,n,s,ball,e,o,a)}}else 0===n.infMin&&n.isActivating&&distance(n.posX,n.posY,s.posX,s.posY)<=n.meleeRadius+s.baseRadius&&distance(mouX,mouY,s.posX,s.posY)<s.baseRadius&&(message=`${n.name} has no influence to attack ${s.name}.`,$("#app").empty(),$("#app").append(appMaker(n,e)))}function endSquaddieActivation(e,t,n,i,o,a,s){message="",diceRolledForDisplay=[],$teamplays=[],e.hasActivated=!0,a.forEach(e=>{e.kickReRoll=0,e.isActivating=!1,e.isMoving=!1,e.hasMoved=!1,e.isCharging=!1,e.isAttacking=!1,e.isKicking=!1,e.hasSnapped=!1,e.isDodging=!1,e.isPushed=!1,e.bonusTime=!1,movementHistory=[],e.hasSnapped=!1}),0===a.filter(e=>!e.hasActivated).length&&(a.forEach(e=>{e.kickReRoll=0,e.isActivating=!1,e.hasActivated=!1,e.isMoving=!1,e.hasMoved=!1,e.isCharging=!1,e.wasCharging=!1,e.isAttacking=!1,e.hasAttacked=!1,e.isKicking=!1,e.hasKicked=!1,e.heal=0,e.removedConditions=0,e.infMin=0,e.remainingRun=e.run*inch,e.remainingSprint=e.sprint*inch,e.runPaid=!1,e.isCharging=!1,e.pressedAbutton=!1,e.counterForAttack=[],e.isGliding=!1,e.bonusTime&&(e.bonusTime=!1,i.momentum++),e.isPoisoned&&(e.hpMin-=2),e.isBleeding&&(e.hpMin-=3,e.isBleeding=!1),e.isBurning&&(e.hpMin-=1),e.hpMin<1&&(e.isTakenOut||(i.score+=2,e.hasBall&&(e.hasBall=!1,ball.isOnGround=!0,scatterRandomiser(e.posX,e.posY,!1)),e.hpMin=e.icySponge,e.posX=void 0,e.posY=void 0,e.hasActivated=!0,e.hasMoved=!0,e.isPushed=!1,e.isDodging=!1,e.isTakenOut=!0,e.isBurning=!1,e.isBleeding=!1,e.isDiseased=!1,e.isKnockedDown=!1,e.isPoisoned=!1,e.isSnared=!1,e.isActivating=!1,e.isMoving=!1,e.isAttacking=!1,e.hasAttacked=!1,e.isKicking=!1,e.hasKicked=!1,e.counterForAttack=[]))}),counter++),5===counter?o(event):counter>5&&s(event),$("#appDisplay").slideUp(),plajBookWraz()}function drawCircle(e,t,n,i){ctx.beginPath(),ctx.arc(e,t,n,0,2*Math.PI,!1),ctx.fillStyle=i,ctx.fill(),ctx.closePath(),ctx.fill(),ctx.stroke()}function distance(e,t,n,i){let o=e-n,a=t-i;return Math.sqrt(Math.pow(o,2)+Math.pow(a,2))}function drawCross(e,t,n,i){sctx.beginPath(),sctx.strokeStyle=i,sctx.fillStyle=i,sctx.moveTo(e,t),sctx.lineTo(e,t+n),sctx.lineTo(e+n,t+n),sctx.lineTo(e+n,t),sctx.lineTo(e+2*n,t),sctx.lineTo(e+2*n,t-n),sctx.lineTo(e+n,t-n),sctx.lineTo(e+n,t-2*n),sctx.lineTo(e,t-2*n),sctx.lineTo(e,t-n),sctx.lineTo(e-n,t-n),sctx.lineTo(e-n,t),sctx.closePath(),sctx.lineWidth=1,sctx.stroke(),sctx.fill()}function heals(e){drawCross(34,49,4,e),drawCross(40,31,3,e),drawCross(30,35,2,e),drawCross(48,40,2.5,e)}function drawSword(){sctx.beginPath(),sctx.strokeStyle="rgb(185, 190, 178)",sctx.arc(49,31,2,0,2*Math.PI),sctx.moveTo(30,50),sctx.lineTo(50,30),sctx.moveTo(38,32),sctx.lineTo(47,42),sctx.moveTo(43,36),sctx.lineTo(28,48),sctx.lineTo(25,54),sctx.lineTo(32,52),sctx.lineTo(44,38),sctx.closePath(),sctx.fillStyle="grey",sctx.lineWidth=1,sctx.fill(),sctx.stroke()}function legalPlacementDetector(e){let t=mouX,n=mouY;const i=e.baseRadius+3,o=[[t-i,n,1,1],[t-.73*i,n-.73*i,1,1],[t-1,n-i,1,1],[t-1+.73*i,n-.73*i,1,1],[t-1+i,n-1,1,1],[t-1+.73*i,n-1+.73*i,1,1],[t-1,n-1+i,1,1],[t-.73*i,n-1+.73*i,1,1]];let a=[],s=[];for(let e=0;e<o.length;e++)a.push(konvas.getImageData(...o[e]).data[3]);for(let e=0;e<filtered_td.length;e++)distance(mouX,mouY,filtered_td[e][1][0],filtered_td[e][1][1])<6*inch&&s.push(filtered_td[e][0].kind);return(!a.includes(255)||a.includes(255)&&!s.includes("wall")&&!s.includes("obstacle"))&&(!ball.isOnGround||distance(mouX,mouY,ball.x,ball.y)>ball.ballSize+e.baseRadius)&&teamz.forEach(t=>t.name!==e.name&&distance(t.posX,t.posY,mouX,mouY)>t.baseRadius+e.baseRadius)&&distance(mouX,mouY,Gamer.gp.x,Gamer.gp.y)>e.baseRadius+2.5*cm&&distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)>e.baseRadius+2.5*cm?(console.log(!0),!0):(console.log(!1),!1)}function mouse(e,t,n){if(sctx.strokeStyle="white",sctx.fillStyle=e.guild.color,sctx.save(),sctx.beginPath(),sctx.translate(mouX,mouY),sctx.moveTo(22,42),sctx.lineTo(0,0),sctx.lineTo(20,10),sctx.bezierCurveTo(30,20,20,30,23,45),sctx.moveTo(58,40),sctx.lineWidth=1,sctx.stroke(),sctx.fill(),sctx.stroke(),sctx.beginPath(),sctx.arc(32,22,5,0,2*Math.PI),sctx.fill(),sctx.lineWidth=1,sctx.stroke(),t.squaddies.forEach(n=>{let i=e.squaddies.filter(e=>e.isActivating)[0];if(distance(n.posX,n.posY,mouX,mouY)<=n.baseRadius){drawSword();let o=n;if(showLeaflet){let n=i?i.tac+(o.inCover?-1:0)+(i.wasCharging?4:0)+(i.bonusTime?1:0)+e.squaddies.filter(e=>e.name!==i.name).filter(e=>distance(e.posX,e.posY,o.posX,o.posY)<=e.meleeRadius+o.baseRadius).length-t.squaddies.filter(e=>e.name!==o.name).filter(e=>distance(i.posX,i.posY,e.posX,e.posY)<=e.meleeRadius+i.baseRadius).length:"";if(i&&o&&distance(i.posX,i.posY,o.posX,o.posY)>4*inch){ctx.save(),ctx.translate(i.posX,i.posY),ctx.rotate(angle(i.posX,i.posY,o.posX,o.posY)),ctx.font="900 24px IM Fell English ",ctx.fillStyle="rgba(255,255,255,.4)",ctx.strokeStyle="rgba(80,80,80,.4)",ctx.textAlign="center",ctx.lineWidth=15;let e=distance(i.posX,i.posY,o.posX,o.posY)/inch;ctx.strokeText("<-- "+parseFloat(e).toFixed(1)+'" --\x3e',e/2*inch,0),ctx.fillText("<-- "+parseFloat(e).toFixed(1)+'" --\x3e',e/2*inch,0),ctx.closePath(),ctx.restore()}sctx.beginPath(),sctx.lineWidth=15,sctx.font="900 42px IM Fell English ",sctx.fillStyle=i&&n>i.tac?"blue":i&&n===i.tac?"green":"red",sctx.strokeStyle=purpleColor,sctx.textAlign="center",sctx.strokeText(n,0,-28),sctx.fillText(n,0,-28)}}if(i&&distance(t.gp.x,t.gp.y,mouX,mouY)<=2.5*cm){ctx.save(),ctx.translate(i.posX,i.posY),ctx.rotate(angle(i.posX,i.posY,t.gp.x,t.gp.y)),ctx.font="900 24px IM Fell English ",ctx.fillStyle="rgba(255,255,255,.4)",ctx.strokeStyle="rgba(80,80,80,.4)",ctx.textAlign="center",ctx.lineWidth=15;let e=distance(i.posX,i.posY,t.gp.x,t.gp.y)/inch;ctx.strokeText("<-- "+parseFloat(e).toFixed(2)+'" --\x3e',e/2*inch,0),ctx.fillText("<-- "+parseFloat(e).toFixed(2)+'" --\x3e',e/2*inch,0),ctx.closePath(),ctx.restore()}}),showLeaflet&&mouX>0&&konvas.getImageData(mouX,mouY,1,1).data[3]>0)for(let e=0;e<filtered_td.length;e++)if(distance(mouX,mouY,filtered_td[e][1][0],filtered_td[e][1][1])<6*inch){console.log(filtered_td[e][0].kind),sctx.beginPath(),sctx.lineWidth=15,sctx.globalAlpha=.42,sctx.font="900 21px IM Fell English ",sctx.fillStyle="rgb(133, 176, 233)",sctx.strokeStyle="rgba(79, 82, 78, 0.753)",sctx.textAlign="center";for(let t=0;t<filtered_td[e][0].description.length;t++)sctx.strokeText(filtered_td[e][0].description[t],0,24*t-52);for(let t=0;t<filtered_td[e][0].description.length;t++)sctx.fillText(filtered_td[e][0].description[t],0,24*t-52);sctx.closePath()}2===healCursor&&e.squaddies.filter(t=>e.momentum>(t.isDiseased?2:1)).filter(e=>distance(mouX,mouY,e.posX,e.posY)<=e.baseRadius).filter(e=>e.removedConditions<1).filter(e=>e.heal<2).filter(e=>hasConditions(e)).length>0?heals("blue"):1===healCursor&&e.squaddies.filter(t=>e.momentum>(t.isDiseased?2:1)).filter(e=>distance(mouX,mouY,e.posX,e.posY)<=e.baseRadius).filter(e=>e.hpMin<e.hp).filter(e=>e.heal<1).filter(e=>e.removedConditions<2).length>0&&heals("red"),sctx.restore(),sctx.stroke()}function modelInfo(e){sctx.save(),sctx.globalAlpha=.5,sctx.lineWidth=1,sctx.translate(mouX<100?mouX:mouX>canvas.width-120?mouX-225:mouX-113,mouY<canvas.height/2?mouY+60:mouY-350),sctx.beginPath(),sctx.drawImage(leafletBackground,0,0,250,300),sctx.font="800 25px IM Fell English",sctx.textAlign="center",sctx.fillStyle="black",sctx.fillText(e.name,125,35),sctx.font="800 12px IM Fell English";const t=e.inCover&&e.inRoughGround?"in forest":e.inCover?"in cover":e.inFastGround?"on fast ground":e.inRoughGround?"on rough terrain":"";sctx.fillText(t,25,50);for(let t=0;t<6;t++){sctx.save();let n=["MOV","TAC","KICK","DEF","ARM","INF"],i=[[e.sprint,e.run],e.tac,[e.kick,e.kickDist],e.def,e.arm,[e.infMin,e.infMax]];sctx.beginPath(),sctx.globalAlpha=.2,sctx.fillStyle=e.theGuild.color,sctx.fillRect(40*t+6,64,38,30),sctx.stroke(),sctx.fill(),sctx.restore(),sctx.fillStyle="black",sctx.fillText(n[t],40*t+26,76),sctx.fillText(i[t],40*t+26,90),sctx.stroke(),sctx.fill()}sctx.beginPath(),sctx.strokeStyle=e.theGuild.color,sctx.moveTo(10,80),sctx.lineTo(240,80),sctx.globalAplha=1;for(let t=0;t<e.playBook.length;t++){let n=27*(t+1),i=n-5,o=n+5,a=117,s=125,r=127;if(0===e.playBook[t][0].length);else{let r=e.playBook[t][0][0],l=e.playBook[t][0][1],c=e.playBook[t][0][2],d=e.playBook[t][0][3],u=e.playBook[t][0][4],p=e.playBook[t][0][5];sctx.beginPath(),1===l?(sctx.fillStyle=e.theGuild.color,sctx.strokeStyle="white"):(sctx.fillStyle="white",sctx.strokeStyle="black"),sctx.arc(n,a,13,0,2*Math.PI),sctx.fill(),sctx.stroke(),sctx.lineWidth=1,sctx.font="800 12px Arial",sctx.textAlign="center",1===l?(sctx.fillStyle="white",sctx.strokeStyle="white"):(sctx.fillStyle="black",sctx.strokeStyle="black"),0!==r&&(sctx.fillText(r,n,c>0||d>0||p>0||u>0?a:s),sctx.closePath()),c>2?(sctx.fillText("<<<",d>0?i:n,s),sctx.closePath()):2===c?(sctx.fillText("<<",d>0?i:n,s),sctx.closePath()):1===c&&(sctx.fillText("<",d>0?i:n,s),sctx.closePath()),d>2?(sctx.fillText(">>>",c>0?o:n,s),sctx.closePath()):2===d?(sctx.fillText(">>",c>0?o:n,s),sctx.closePath()):1===d&&(sctx.fillText(">",c>0?o:n,s),sctx.closePath()),1===u&&(sctx.fillText("T",n,r>0||c>0||d>0?a:p>0?a:s),sctx.closePath()),1===p&&(sctx.fillText("KD",n,r>0||c>0?a:u>0?a:s),sctx.closePath()),sctx.stroke()}a+=28,s+=28,r+=28;let l=e.playBook[t][1][0],c=e.playBook[t][1][1],d=e.playBook[t][1][2],u=e.playBook[t][1][3],p=e.playBook[t][1][4],h=e.playBook[t][1][5];sctx.beginPath(),1===c?(sctx.fillStyle=e.theGuild.color,sctx.strokeStyle="white"):(sctx.fillStyle="white",sctx.strokeStyle="black"),sctx.arc(n,a,12,0,2*Math.PI),sctx.fill(),sctx.stroke(),sctx.lineWidth=1,sctx.font="900 12px Arial",sctx.textAlign="center",1===c?(sctx.fillStyle="white",sctx.strokeStyle="white"):(sctx.fillStyle="black",sctx.strokeStyle="black"),0!==l&&(sctx.fillText(l,n,d>0||u>0||h>0||p>0?a:s),sctx.closePath()),d>2?(sctx.fillText("<<<",u>0?i:n,s),sctx.closePath()):2===d?(sctx.fillText("<<",u>0?i:n,s),sctx.closePath()):1===d&&(sctx.fillText("<",u>0?i:n,s),sctx.closePath()),u>2?(sctx.fillText(">>>",d>0?o:n,s),sctx.closePath()):2===u?(sctx.fillText(">>",d>0?o:n,s),sctx.closePath()):1===u&&(sctx.fillText(">",d>0?o:n,s),sctx.closePath()),1===p&&(sctx.fillText("T",n,l>0||d>0||h>0||u>0?s:a),sctx.closePath()),1===h&&(sctx.fillText("KD",n,l>0||d>0||h>0||p>0?a:s),sctx.closePath()),sctx.stroke()}let n=[e.isDiseased,e.isBleeding,e.isBurning,e.isKnockedDown,e.isPoisoned,e.isSnared],i=[,bleedingIco,burningIco,knockedDownIco,poisonIco,snaredIco];for(let e=0;e<n.length;e++)sctx.save(),sctx.beginPath(),!0===n[e]&&(0!==e?sctx.drawImage(i[e],23*(e+1),40,20,20):(sctx.fillStyle="rgb(108, 255, 50)",sctx.fillRect(23*(e+1),40,20,20))),sctx.restore();sctx.stroke(),sctx.beginPath(),sctx.lineWidth=19,sctx.font="900 38px IM Fell English ",sctx.fillStyle=e.hpMin===e.hp?"rgb(133, 176, 233)":e.hpMin>e.icySponge?"rgb(247, 201, 0)":"rgb(204, 75, 1)",sctx.strokeStyle="rgba(79, 82, 78, 0.753)",sctx.textAlign="center",sctx.strokeText(e.hpMin,220,40),sctx.fillText(e.hpMin,220,40),sctx.closePath(),sctx.restore()}function escapist(e){document.addEventListener("keydown",t=>{"Escape"===t.key&&(teamz.forEach(e=>{e.canSnap&&(e.canSnap=!1,$("body").find(".snapBallButton").remove())}),e.moveAura=!1,e.isKicking=!1,ball.beingKicked=!1,e.isMoving=!1,e.isCharging&&(e.isCharging=!1,e.hasMoved=!1),e.isCharging=!1,e.pressedAbutton=!1,e.isDodging=!1,e.isPushed=!1,e.dodgeDistance=0,e.pushDistance=0,wrath&&wrath.willCounter&&distance(e.posX,e.posY,wrath.posX,wrath.posY)<=e.baseRadius+wrath.meleeRadius&&$("#app").find(".activeOptions").length<1&&(waaar(otherGamer,Gamer,wrath,receiver,"counterattack"),wrath.willCounter=!1),otherGamer.squaddies.forEach(e=>e.isPushed=!1),healCursor=0,ball.isInHand=!1)})}function drawDeploymentZones(e){if(e<2&&(ctx.fillStyle=blueColor,ctx.beginPath(),ctx.fillRect(0,0,canvas.width,10*inch),ctx.fillStyle=redColor,ctx.beginPath(),ctx.fillRect(0,canvas.height-10*inch,canvas.width,10*inch)),e>6){let e=ctx.createLinearGradient(0,0,canvas.width,canvas.width);e.addColorStop(0,"red"),e.addColorStop(.25,"green"),e.addColorStop(.5,"yellow"),e.addColorStop(.75,"green"),e.addColorStop(1,"blue"),ctx.fillStyle=e,ctx.save(),ctx.globalAlpha=.42,ctx.beginPath(),ctx.fillRect(0,1*inch,1*inch,9*inch),ctx.fillRect(0,0,canvas.width,1*inch),ctx.fillRect(canvas.width-1*inch,1*inch,canvas.width,9*inch),ctx.fillRect(0,canvas.height-10*inch,1*inch,canvas.height-1*inch),ctx.fillRect(inch,canvas.height-inch,canvas.width-2*inch,canvas.height),ctx.fillRect(canvas.width-1*inch,canvas.height-10*inch,canvas.height-1*inch,canvas.width-1*inch),ctx.restore()}}function sendMessage(e){message="you hve to allocate ball to the initial kicker first",$("#app").find(".message").text(e)}const snapBallButtonCreator=(e,t)=>ball.isOnGround?teamz.filter(t=>distance(t.posX,t.posY,ball.x,ball.y)<=t.baseRadius+ball.ballSize+("end"===e?inch:0)).filter(e=>e.name!==t).filter(e=>!e.canSnap).filter(e=>!e.isKnockedDown).forEach(e=>{e.canSnap=!0,$("body").append(`<div id="snapBall${e.name}" class="snapBallButton" style=" top:${e.posY-e.baseRadius+2}px; left:${e.posX-e.baseRadius+2}px; width:${2*e.baseRadius}px; height:${2*e.baseRadius}px; background-color:${e.theGuild.color}; ">snap<br>&nbsp;ball</div>`),$("#snapBall"+e.name).on("click",()=>{$("body").find(".snapBallButton").remove(),teamz.forEach(e=>{e.hasBall=!1,e.canSnap=!1}),e.hasBall=!0,ball.isOnGround=!1})}):"",generatePuddle=e=>{let t=[];for(let n=0;n<e.hp;n++)t.push(Math.random()-.5);console.log(e),puddles.push({x:e.posX,y:e.posY,size:e.baseRadius,segments:e.hp,shape:t})},drawPuddle=(e,t,n,i,o,a)=>{e.strokeStyle="rgba(141, 4, 4, 0.022)",e.fillStyle="rgba(141, 0, 0, 0.092)",e.save(),e.translate(i,o),e.beginPath(),e.lineWidth=10;for(let i=0;i<a.length;i++)e.rotate(2*Math.PI/a.length),e.lineTo(t-t*n*a[i]/2-10,0);e.closePath(),e.fill(),e.stroke(),e.restore()};function anime(e,t,n,i){movementHistory.push([[e.posX,e.posY],[e.remainingSprint,e.remainingRun],e.name]);let o,a,s=e.posX,r=e.posY,l=e.posX,c=e.posY;const d=7*Math.abs(distance(l,c,mouX,mouY));let u,p=420>d?420:d,h=i.ox||mouX,m=i.oy||mouY;"charging"===i.mode&&e.isKnockedDown?(h=e.posX,m=e.posY,endSquaddieActivation(e,Gamer1,Gamer2,Gamer,switcher,teamz)):Boolean(!e.isDodging&&!e.isPushed)&&e.isKnockedDown?(h=e.posX,m=e.posY):"charging"===i.mode&&(e.isCharging=!0);let f=[];for(let t=0;t<n.squaddies.length;t++){let i=n.squaddies[t];e.posX>0&&distance(i.posX,i.posY,e.posX,e.posY)<=e.baseRadius+i.meleeRadius&&f.push(i)}let g=d=>{u||(u=d);let v=(d-u)/p;if(e.posX>0&&(e.isMoving||e.isCharging)){let o=[];for(cE=0;cE<n.squaddies.length;cE++)cEm2=n.squaddies[cE],distance(cEm2.posX,cEm2.posY,e.posX,e.posY)<=e.baseRadius+cEm2.meleeRadius&&o.push(cEm2);if(o.length<=f.length){let a=f.filter(e=>!(o.indexOf(e)>-1)&&e);v=a.length>0?1.1:v;const s=()=>{anime(e,t,n,{ox:h,oy:m,mode:i.mode})};a.forEach((t,i)=>{waaar(Gamer,n,t,e,"parting blow",s),a.splice(i,1)})}else o.length>f.length&&(f=o)}let y=distance(e.posX,e.posY,18*inch,6*inch-2.5*cm)<2.5*cm||distance(e.posX,e.posY,18*inch,30*inch+2.5*cm)<2.5*cm,b=t.some(t=>distance(e.posX,e.posY,t.posX,t.posY)<=e.baseRadius+t.baseRadius&&t.name!==e.name);if(v>=1||b||y||e.shouldntBeHere>1||(e.isCharging||distance(e.posX,e.posY,h,m)>=e.remainingRun-e.baseRadius)&&1===e.shouldntBeHere||e.isMoving&&e.remainingRun<5+e.baseRadius){if(!b&&!y&&v<=1?(e.posX=l+(h-l)*v,e.posY=c+(m-c)*v):(b||y||e.shouldntBeHere>1||e.isCharging&&1===e.shouldntBeHere)&&(wallCrushed=!0,collisionBouncer(e,teamz)),e.isMoving&&e.isActivating?(e.remainingSprint<26||e.remainingRun<26)&&(e.moveAura=!1):e.isPushed?(e.pushDistance-=distance(e.posX,e.posY,l,c),e.pushDistance<.22*inch&&(e.isPushed=!1,$("#app").find(".activeOptions").length<1&&wrath.willCounter&&!teamz.some(e=>e.isDodging)&&(distance(e.posX,e.posY,receiver.posX,receiver.posY)<=wrath.meleeRadius+receiver.baseRadius&&waaar(n,Gamer,wrath,receiver,"counterattack"),wrath.willCounter=!1)),e.isActivating?console.log(e.posX,e.posY):snapBallButtonCreator("end")):e.isDodging&&(e.dodgeDistance-=distance(e.posX,e.posY,l,c),e.dodgeDistance<.22*inch&&(e.isDodging=!1,$("#app").find(".activeOptions").length<1&&wrath&&wrath.willCounter&&!teamz.some(e=>e.isPushed)&&(distance(e.posX,e.posY,receiver.posX,receiver.posY)<=wrath.meleeRadius+receiver.baseRadius&&waaar(n,Gamer,wrath,receiver,"counterattack"),wrath.willCounter=!1)),e.isActivating?console.log(e.posX,e.posY):snapBallButtonCreator("end")),u=null,(b||y)&&(e.posX=s,e.posY=r),e.isCharging&&(v>=1||1===e.shouldntBeHere)){e.isCharging=!1;let t=[];for(let i=0;i<n.squaddies.length;i++){let o=n.squaddies[i];distance(e.posX,e.posY,o.posX,o.posY)<=o.baseRadius+e.meleeRadius&&t.push(o)}(e.isKnockedDown||t.length<1&&(1===e.shouldntBeHere||distance(e.posX,e.posY,h,m)<=10))&&endSquaddieActivation(e,Gamer1,Gamer2,Gamer,switcher,teamz)}(ball.isOnGround&&distance(e.posX,e.posY,ball.x,ball.y)<=e.baseRadius+ball.ballSize||e.shouldntBeHere>0)&&(e.posX=o,e.posY=a)}else isNaN(e.posX)||(s=e.posX,r=e.posY,ball.isOnGround&&distance(e.posX,e.posY,ball.x,ball.y)>e.baseRadius+ball.ballSize&&e.shouldntBeHere<1&&(o=e.posX,a=e.posY)),e.posX=l+(h-l)*v,e.posY=c+(m-c)*v,e.posX>0&&e.isMoving&&e.isActivating&&(e.remainingSprint-=distance(e.posX,e.posY,s,r),e.remainingRun-=distance(e.posX,e.posY,s,r)),requestAnimationFrame(g)};g()}class Ball_marker{constructor(e,t){this.x=e,this.y=t,this.newX=540,this.newY=340,this.degree=Math.PI/180,this.direction=[30,50,70,110,130,150],this.angluar=Math.atan2(this.x-mouX,mouY-this.y),this.ballPic=new Image,this.ballPic.src="./icons/cursor/32853911-0-GB-logo-Ball-white.png",this.ballSize=1.2*cm,this.isOnGround=!0,this.beingKicked=!1,this.isInHand=!1,this.teaMate=0}draw_ball(){this.isOnGround&&(ctx.beginPath(),aurora(this.x,this.y,this.ballSize,this.x,this.y,1.2*cm+1*inch,"rgba(187, 223, 130, 0.3)","rgba(187, 223, 130, 0.7)"),ctx.strokeStyle="rgba(237, 240, 57, 0.5)",ctx.lineWidth=1,ctx.stroke(),ctx.beginPath(),ctx.arc(this.x-2/this.ballSize,this.y-2/this.ballSize,this.ballSize,0,2*Math.PI,!1),ctx.fillStyle="rgba(31, 30, 22, 0.5)",ctx.fill(),ctx.drawImage(this.ballPic,this.x-.9*cm,this.y-.9*cm,1.8*cm,1.8*cm),ctx.save(),ctx.clip(),ctx.closePath(),ctx.restore()),distance(mouX,mouY,this.x,this.y)<this.ballSize&&(ctx.save(),ctx.fillStyle="black",ctx.beginPath(),ctx.globalAlpha=.7,ctx.font="900 18px IM Fell English ",ctx.fillText("Ooohh ball!",mouX,mouY),ctx.restore())}doppler(){if(this.beingKicked||this.isInHand){if(ctx.beginPath(),ctx.arc(mouX-2/this.ballSize,mouY-2/this.ballSize,1.2*cm+1*inch,0,2*Math.PI),ctx.fillStyle="rgba(187, 223, 130, 0.1)",ctx.fill(),ctx.strokeStyle="rgba(237, 240, 57, 0.1)",ctx.lineWidth=1,ctx.stroke(),ctx.beginPath(),ctx.arc(mouX-2/this.ballSize,mouY-2/this.ballSize,this.ballSize,0,2*Math.PI,!1),ctx.fillStyle="rgba(31, 30, 22, 0.5)",ctx.fill(),ctx.drawImage(this.ballPic,mouX-.9*cm,mouY-.9*cm,1.8*cm,1.8*cm),ctx.save(),ctx.clip(),ctx.closePath(),ctx.restore(),this.beingKicked){let e=Math.atan2(this.x-mouX,mouY-this.y),t=Math.atan2(this.x-mouX,mouY-this.y)+Math.PI;ctx.beginPath(),ctx.strokeStyle="#FFFFFF",ctx.fillStyle="#00FF00",ctx.lineWidth=3;let n=e=>7*Math.cos(this.direction[e]*this.degree+Math.atan2(this.x-mouX,mouY-this.y))*inch+mouX,i=e=>7*Math.sin(this.direction[e]*this.degree+Math.atan2(this.x-mouX,mouY-this.y))*inch+mouY;ctx.arc(mouX,mouY,50,e,t);for(let e=0;e<=this.direction.length;e++)ctx.moveTo(mouX,mouY),ctx.lineTo(n(e),i(e));ctx.stroke(),ctx.restore()}ctx.stroke()}}drawDropAura(e=this.teaMate){this.teaMate=e,ball.isInHand&&drawCircle(ball.x,ball.y,this.teaMate+1*inch+2*ball.ballSize,kickColor)}}const ball=new Ball_marker(540,540);function scatterRandomiser(e=mouX,t=mouY,n,i){i.hasBall=!1,ball.isOnGround=!0,neSpotx=e,neSpoty=t;let o=Math.PI/180,a=n?[30,50,70,110,130,150]:[60,120,180,240,300,360],s=Math.floor(5*Math.random()),r=Math.floor(6*Math.random())+2;diceRolled([s+1,r-1],0,"black"),console.log("direction: ",s,", distance: ",r);let l,c,d,u=ball.x,p=ball.y,h=Math.cos(a[s]*o+Math.atan2(ball.x-e,t-ball.y))*r*inch+e,m=Math.sin(a[s]*o+Math.atan2(ball.x-e,t-ball.y))*r*inch+t,f=e=>{d||(d=e);let t=(e-d)/537;if(t>=1)u=h,p=m,d=null,i.hasDropped=!1,teamz.some(e=>distance(e.posX,e.posY,ball.x,ball.y)<=e.baseRadius+ball.ballSize)&&(ball.x=l,ball.y=c),snapBallButtonCreator("end");else{const e=i.name;snapBallButtonCreator("",e),ball.x=u+(h-u)*t,ball.y=p+(m-p)*t,teamz.some(e=>distance(e.posX,e.posY,ball.x,ball.y)<=e.baseRadius+ball.ballSize)||(l=ball.x,c=ball.y),requestAnimationFrame(f)}};f()}class GoalPost{constructor(e,t,n){this.x=e,this.y=t,this.kickDist=10*inch+2.5*cm,this.hasBall=!1,this.isKicking=!1,this.color=n,this.ballPic=new Image,this.ballPic.src="./icons/cursor/32853911-0-GB-logo-Ball-white.png"}drawGoalPost(e,t,n){ctx.beginPath(),ctx.arc(this.x,this.y,2.5*cm,0,2*Math.PI,!1),ctx.fillStyle=this.color,ctx.fill(),ctx.drawImage(this.ballPic,this.x-2*cm,this.y-2*cm,4*cm,4*cm),ctx.closePath(),this.hasBall&&this.isKicking&&(ball.beingKicked=!0,ctx.beginPath(),ctx.arc(this.x,this.y,2.5*cm+10*inch,0,2*Math.PI,!1),ctx.fillStyle=kickColor,ctx.fill(),ctx.closePath()),ctx.beginPath(),ctx.lineWidth=3,ctx.font="900 38px IM Fell English",ctx.fillStyle=this.color,ctx.strokeStyle="rgba(8, 21, 37,0.55)",ctx.textAlign="center",ctx.strokeText(t,this.x,this.y+14),ctx.fillText(t,this.x,this.y+14),ctx.closePath();for(let t=0;t<e;t++){let e=Math.PI/180;ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(18*(1+t)*e+45*e),ctx.beginPath(),ctx.fillStyle="blue",ctx.lineWidth=1.6,ctx.arc(0,1.9*cm,6,2*Math.PI,0),ctx.fill(),ctx.stroke(),ctx.beginPath(),ctx.lineWidth=1,ctx.font="900 12px IM Fell English",ctx.fillStyle="white",ctx.textAlign="center",ctx.fillText(t+1,0,1.9*cm+3),ctx.closePath(),ctx.restore()}for(let e=0;e<n;e++){let t=Math.PI/180;ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(15*(1+e)*t+45*t),ctx.beginPath(),ctx.fillStyle="yellow",ctx.lineWidth=1,ctx.arc(0,1.6*cm,5,2*Math.PI,0),ctx.fill(),ctx.stroke(),ctx.beginPath(),ctx.lineWidth=1,ctx.font="900 12px IM Fell English",ctx.fillStyle="black",ctx.textAlign="center",ctx.fillText(e+1,0,1.6*cm+2),ctx.closePath(),ctx.restore(),ctx.restore()}distance(this.x,this.y,mouX,mouY)<2.5*cm&&(ctx.save(),ctx.beginPath(),ctx.globalAlpha=.7,ctx.fillRect(mouX-140,mouY-20,280,27),ctx.beginPath(),ctx.fillStyle="black",ctx.font="900 24px IM Fell English ",ctx.fillText("momentum: "+e+"      score: "+t,mouX,mouY),ctx.restore())}}class Terrain{constructor(e,t,n,i,o,a,s,r){this.x,this.y,this.type,this.picture,this.sizeX,this.sizeY,this.rotation,this.bounduaries}}const sizeRandomiser=e=>{const t=Math.random();return{img:new Image,dir:e.dir,size:[(t*(e.size[1]-e.size[0])+e.size[0])*inch,(t*(e.size[3]-e.size[2])+e.size[2])*inch],kind:e.kind,rotation:2.5*Math.PI*Math.random(),description:e.description}};function terrainsDetector(e){if(e.posX>0&&filtered_td.length>0){let t=e.posX,n=e.posY;const i=.3,o=.73,a=1,s=e.baseRadius+3,r=[[t-s,n,a,a],[t-o*s,n-o*s,a,a],[t-a,n-s,a,a],[t-a+o*s,n-o*s,a,a],[t-a+s,n-a,a,a],[t-a+o*s,n-a+o*s,a,a],[t-a,n-a+s,a,a],[t-o*s,n-a+o*s,a,a]],l=[[t-inch-s,n,a,a],[t-inch-i*s,n-inch-i*s,a,a],[t-a,n-inch-s,a,a],[t-a+inch+i*s,n-inch-i*s,a,a],[t-a+inch+s,n-a,a,a],[t-a+inch+i*s,n-a+inch+i*s,a,a],[t-a,n-a+inch+s,a,a],[t-inch-i*s,n-a+inch+i*s,a,a]];let c=[],d=[],u=[];for(let e=0;e<l.length;e++)c.push(konvas.getImageData(...l[e]).data[3]),d.push(konvas.getImageData(...r[e]).data[3]);for(let t=0;t<filtered_td.length;t++)distance(e.posX,e.posY,filtered_td[t][1][0],filtered_td[t][1][1])<6*inch&&u.push(filtered_td[t][0].kind);c.includes(255)&&(u.includes("wall")||u.includes("obstacle"))||d.includes(255)&&u.includes("forest")||distance(e.posX,e.posY,otherGamer.gp.x,otherGamer.gp.y)<=e.baseRadius+inch+2.5*cm||distance(e.posX,e.posY,Gamer.gp.x,Gamer.gp.y)<=e.baseRadius+inch+2.5*cm?e.inCover=!0:e.inCover=!1,d.includes(255)&&u.includes("wall")?(e.remainingRun=e.remainingSprint,e.shouldntBeHere=1):d.includes(255)&&u.includes("obstacle")?e.shouldntBeHere=2:e.shouldntBeHere=0,!d.includes(255)||e.inRoughGround||!e.isMoving&&!e.isCharging||!u.includes("forest")&&!u.includes("roughGround")||e.isGliding?d.includes(255)||(e.inRoughGround=!1):(e.inRoughGround=!0,e.remainingRun-=2*inch,e.remainingSprint-=2*inch),d.includes(255)&&!e.inFastGround&&(e.isMoving||e.isCharging)&&u.includes("fastGround")?(e.inFastGround=!0,e.remainingRun+=2*inch,e.remainingSprint+=2*inch):d.includes(255)||(e.inFastGround=!1)}}const pitchConstructor=()=>{for(i=0;i<coords.length;i++){let e,t=td.filter(e=>void 0!==e).filter(e=>void 0!==e).filter(e=>e).filter(e=>0!==e).filter(e=>!1!==e).filter(e=>""!==e).filter(e=>NaN!==e).filter(e=>null!==e).filter(e=>e[0].kind),n=(e=t.filter(e=>e).some(e=>"obstacle"===e[0].kind)&&td.filter(e=>e).some(e=>"forest"===e[0].kind)?()=>Math.floor(Math.random()*(tp.length-1))+1:t.filter(e=>e).some(e=>"forest"===e[0].kind)?()=>Math.floor(Math.random()*tp.length)+1:t.filter(e=>e).some(e=>"obstacle"===e[0].kind)?()=>Math.floor(Math.random()*(tp.length-1)):()=>Math.floor(Math.random()*tp.length))(),o=0===i||4===i||5===i||9===i||10===i||14===i,a=2===i||12===i;for(;!o&&1===n||a&&(0===n||n===tp.length-1);)n=e();let s=void 0!==td[i-1]||Boolean(i>4&&void 0!==td[i-5])?-1:.92;Math.random()<=s?td.push([td.filter(e=>void 0!==e).filter(e=>"wall"===e[0].kind).length>td.filter(e=>void 0!==e).filter(e=>"wall"!==e[0].kind).length?sizeRandomiser(tp[n]):sizeRandomiser(tp[3]),coords[i]]):td.push(void 0)}},terrainsGenerator=()=>{let e=konvas;filtered_td.length<1&&(filtered_td=td.filter(e=>void 0!==e).filter(e=>void 0!==e).filter(e=>e).filter(e=>0!==e).filter(e=>!1!==e).filter(e=>""!==e).filter(e=>NaN!==e).filter(e=>null!==e).filter(e=>e[0].kind)),filtered_td.forEach((t,n)=>{t[0].img.crossOrigin="anonymous",t[0].img.src=t[0].dir[n%3],e.save(),e.translate(t[1][0],t[1][1]),e.rotate(2*t[0].rotation),e.drawImage(t[0].img,0-t[0].size[0]/2,0-t[0].size[1]/2,t[0].size[0],t[0].size[1]),e.rect(t[1][0],t[1][1],t[0].size[0],t[0].size[1]),e.restore()})},Brewers={color:"rgb(219, 161, 0)",name:"Brewers",fontColor:"rgb(212, 231, 204)"},esters=new Player(4,6,6,5,3,6,3,1,4,0,6,1,22,2,"./icons/Brewers/esters.jpg","Esters",[[[1,0,0,0,0,0],[0,1,0,1,0,0]],[[],[2,1,0,0,0,0]],[[0,0,0,2,1,0],[0,1,0,0,0,1]],[[],[3,1,0,0,0,0]]],11,Brewers),tapper=new Player(5,7,7,6,3,6,3,1,3,0,6,2,18,1,"./icons/Brewers/tapper.jpg","Tapper",[[[1,0,0,0,0,0],[0,1,0,0,0,1]],[[2,0,0,0,0,0],[0,1,0,1,0,0]],[[0,0,0,0,1,0],[0,1,0,2,0,0]],[[0,0,0,0,0,0],[3,1,0,0,0,0]],[[],[0,1,0,3,0,0]]],9,Brewers),quaff=new Player(6,8,8,3,1,4,4,1,1,0,3,1,8,2,"./icons/Brewers/quaff.jpg","Quaff",[[[1,0,0,0,0,0],[0,1,0,1,0,0]],[[0,0,0,0,1,0],[0,1,0,2,0,0]]],4,Brewers),scum=new Player(6,8,8,4,1,4,5,0,1,0,2,1,6,1,"./icons/Brewers/scum,jpg","Scum",[[[],[1,0,0,0,0,0]],[[0,1,0,1,0,0],[2,1,0,0,0,0]],[[],[0,0,0,0,1,0]]]),vetDecimate=new Player(5,7,7,5,3,6,3,1,2,0,4,2,14,1,"picture source","vet. Decimate",[[[],[1,0,0,1,0,0]],[[2,0,0,1,0,0],[0,1,0,2,0,0]],[[0,1,0,0,0,0],[0,1,0,1,1,0]],[[],[3,1,0,1,0,0]],[[],[0,1,0,0,0,1]]]),friday=new Player(6,8,8,4,3,8,4,1,2,0,4,1,12,1,"./icons/Brewers/friday.jpg","Friday",[[[1,0,0,0,0,0],[0,1,0,0,1,0]],[[2,0,0,0,0,0],[0,1,0,1,0,0]],[[],[0,0,0,0,0,0]]],6,Brewers),hooper=new Player(5,7,7,5,2,6,3,1,2,0,3,2,16,1,"./icons/Brewers/hooper.jpg","Hooper",[[[1,0,0,0,0,0],[0,1,0,1,0,0]],[[0,0,0,0,1,0],[2,0,0,0,0,0]],[[0,0,0,0,0,0],[0,1,0,0,0,1]],[[3,1,0,0,0,0],[0,1,0,2,0,0]],[[],[4,1,0,0,0,0]]],7,Brewers),lucky=new Player(5,8,8,5,3,6,4,1,2,0,4,1,14,1,"pic src","Lucky",[[[],[1,0,0,0,0,0]],[[0,1,0,0,1,0],[2,1,0,0,0,0]],[[0,0,1,1,0,0],[0,1,0,0,0,1]],[[],[3,1,0,0,0,0]],[[],[4,0,0,0,0,0]]],7,Brewers),mash=new Player(4,6,6,5,3,6,3,1,2,0,4,2,15,2,"./icons/Brewers/mash.jpg","Mash",[[[],[1,0,0,0,0,0]],[[2,0,0,0,0,0],[0,1,0,1,1,0]],[[0,1,0,0,0,1],[0,1,0,0,0,0]],[[],[3,1,0,0,0,0]]],8,Brewers),pintpot=new Player(5,7,7,6,2,6,3,1,2,0,2,1,20,1,"./icons/Brewers/pintpot.jpg","Pintpot",[[[],[1,0,0,0,0,0]],[[],[1,1,0,1,0,0]],[[0,1,0,0,0,1],[2,1,0,1,0,0]],[[],[0,1,0,0,0,0]],[[0,0,0,0,1,0],[3,1,0,1,0,0]]],10,Brewers),spigot=new Player,Hunters={color:"rgb(0, 100, 0)",name:"Hunters",fontColor:"rgb(0, 100, 0)"},theron=new Player(5,8,8,6,3,6,4,1,4,0,6,1,16,1,"./icons/Hunters/Theron.jpg","Theron",[[[0,0,1,0,0,0],[1,1,0,0,0,0]],[[0,0,0,2,0,0],[0,1,0,1,0,0]],[[0,0,0,0,1,0],[2,1,0,0,0,0]],[[0,1,0,2,0,0],[0,1,0,0,0,1]],[[],[3,1,0,0,0,0]],[[],[4,0,0,0,0,0]]],8,Hunters),skatha=new Player(7,9,9,5,4,6,5,0,4,0,6,1,14,1,"./icons/Hunters/Skatha.jpg","Skatha",[[[0,1,0,0,1,0],[0,1,1,0,0,0]],[[1,0,0,0,0,0],[0,0,2,0,0,0]],[[0,0,0,0,0,0],[2,1,0,0,0,0]],[[0,0,0,0,0,1],[0,1,2,0,0,0]],[[],[3,0,0,0,0,0]]],7,Hunters),fahad=new Player(6,8,8,3,1,4,5,0,1,0,2,1,6,2,"./icons/Hunters/Fahad.jpg","Fahad",[[[],[1,0,0,0,0,0]],[[0,0,0,0,1,0],[1,1,1,0,0,0]],[[],[2,1,1,0,0,0]]],3,Hunters),snow=new Player(5,7,7,3,2,6,4,0,1,0,3,1,8,1),chaska=new Player(5,8,8,5,3,6,3,1,2,0,4,1,16,1),egret=new Player(6,8,8,4,3,8,4,1,2,0,4,1,12,1,"./icons/Hunters/Egret.jpg","Egret",[[[1,0,0,0,0,0],[0,1,1,0,0,0]],[[0,0,2,0,0,0],[0,1,0,0,1,0]],[[],[1,0,0,0,1,0]],[[2,0,0,0,0,0],[0,1,1,1,0,0]]],6,Hunters),hearne=new Player(4,6,6,5,3,6,3,1,1,0,3,2,20,2,"./icons/Hunters/Hearne.jpg","Hearne",[[[1,0,0,0,0,0],[0,1,0,0,0,0]],[[0,0,0,1,0,0],[2,1,0,0,0,0]],[[0,0,0,0,0,1],[0,1,0,2,0,0]],[[0,0,0,0,1,0],[3,1,0,0,0,0]],[[],[0,1,0,0,0,0]]],10,Hunters),vetHearne=new Player(4,6,6,5,3,6,3,1,2,0,3,2,20,2),jaecar=new Player(7,9,9,6,2,6,4,0,2,0,4,1,14,1,"./icons/Hunters/Jaecar.jpg","Jaecar",[[[0,0,0,0,0,0],[1,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[2,1,1,0,0,0,0]],[[0,0,0,0,1,0,0],[2,1,2,0,0,0,0]],[[2,0,0,0,0,0,0],[2,1,1,1,0,0,0]],[[],[3,0,0,0,0,0,0]],[[],[4,1,0,0,0,0,0]]],7,Hunters),vetMinx=new Player(7,9,9,5,3,6,4,1,2,0,4,2,12,1),seenah=new Player(5,7,7,7,1,4,3,0,1,0,2,2,21,3,"./icons/Hunters/Seenah.jpg","Seenah",[[[0,0,0,1,0,0],[1,1,0,0,0,0]],[[0,0,0,0,0,1],[2,1,0,0,0,0]],[[],[3,1,0,0,0,0]],[[0,0,0,0,1,0],[4,1,0,0,0,0]],[[0,1,0,0,0,0],[5,1,0,0,0,0]],[[],[6,1,0,0,0,0]]],11,Hunters),ulfr=new Player(6,8,8,4,3,8,4,0,2,0,4,1,16,1),zarola=new Player(5,8,8,5,3,6,5,0,2,0,4,1,12,1),mataagi=new Player(6,9,9,5,2,8,5,0,2,0,4,1,10,1),minerva=new Player(5,7,7,5,3,6,4,0,2,0,3,2,15,1);let Gamer1influenceTemplate=jaecar.infGen+seenah.infGen+egret.infGen+theron.infGen+hearne.infGen+fahad.infGen,Gamer2influenceTemplate=tapper.infGen+quaff.infGen+friday.infGen+hooper.infGen+mash.infGen+pintpot.infGen;class Gajmer{constructor(e,t,n,i,o,a,s,r,l,c){this.momentum=e,this.score=t,this.goals=n,this.influence=i,this.squaddies=o,this.active=a,this.guild=s,this.gp=new GoalPost(...r,this.guild.color),this.side=c,this.deployment=l}}const fillGameWorld=(e,t)=>{let n=Math.random();Gamer1=e||new Gajmer(0,0,0,Gamer1influenceTemplate,[seenah,egret,jaecar,theron,hearne,fahad],n>.5,Hunters,[18*inch,6*inch-2.5*cm],[0,10*inch],"top"),Gamer2=t||new Gajmer(0,0,0,Gamer2influenceTemplate,[quaff,tapper,pintpot,friday,hooper,mash],!(n>.5),Brewers,[18*inch,30*inch+2.5*cm],[26*inch,canvas.height],"bottom"),teamz=[...Gamer1.squaddies,...Gamer2.squaddies],Gamer=n>.5?Gamer1:Gamer2,otherGamer=n>.5?Gamer2:Gamer1};function saveGameState(){}fillGameWorld(),$(e=>{function t(e){6===counter?(Gamer1.influence=Gamer1influenceTemplate+Gamer1.goals,Gamer2.influence=Gamer2influenceTemplate+Gamer2.goals,Gamer1.active=!Boolean(Gamer1.momentum>Gamer2.momentum)||Gamer1.momentum===Gamer2.momentum&&Math.random>.5,Gamer2.active=!Gamer1.active,Gamer1.momentum=Gamer1.active?1:0,Gamer2.momentum=Gamer2.active?1:0,Gamer=Gamer2.active?Gamer2:Gamer1,otherGamer=Gamer2.active?Gamer1:Gamer2,counter++,t(e)):7!==counter&&8!==counter||(Gamer2.active=!!Gamer1.active,Gamer1.active=!Gamer2.active,Gamer=Gamer2.active?Gamer2:Gamer1,otherGamer=Gamer2.active?Gamer1:Gamer2,$("canvas").off(),$("#app").empty().off(),$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`),$("canvas").on("click contextmenu",function(e){e.preventDefault();for(let n=0;n<Gamer.squaddies.length;n++){let i=Gamer.squaddies[n];distance(i.posX,i.posY,mouX,mouY)<i.baseRadius&&($("#app").css("background","url(./icons/cursor/wood.jpg) 0 0 / 390px"),message="time to allocate influence to each player. And move the returning players with drag and drop, they have to touch edge of their team deployment zone, then right-click to initiate free movement, left click to confirm new position.",$("#appDisplay").slideDown(),$("#app").empty().off(),actionButtons(i,Gamer),$("#app").append(appMaker(i,Gamer)),$("#app").on("click",".addInf"+i.name,()=>{Gamer.active&&Gamer.influence>0&&i.infMin<i.infMax&&(Gamer.influence-=1,i.infMin+=1,$("#actionButtons").empty().off().append(actionButtons(i,Gamer)))}),$("#app").on("click",".minInf"+i.name,()=>{Gamer.active&&i.infMin>0&&(Gamer.influence+=1,i.infMin-=1,$("#actionButtons").empty().off().append(actionButtons(i,Gamer)))}),$("#app").on("click",".leaflet"+i.name,()=>{showLeaflet=!showLeaflet}),$("#app").on("click",".passActivation"+i.name,()=>{Gamer.active&&0===Gamer.influence?(counter=counter<=7?8:5,Gamer.squaddies.filter(e=>e.isActivating).forEach(e=>{e.hasMoved=!1,e.isMoving=!1,e.isActivating=!1,e.remainingSprint=e.sprint*inch+e.baseRadius,e.remainingRun=e.run*inch+e.baseRadius}),counter>6?t(e):switcher(e)):(message="allocate all influence first",$("#app").empty().off(),$("#app").append(appMaker(i,Gamer)))}),$("#app").on("click","#undoMove"+i.name,()=>{0===movementHistory.length&&console.log("time to undo activation"),i.name===movementHistory[mHi][2]&&(mHi=movementHistory.length,i.posX=movementHistory[mHi-1][0][0],i.posY=movementHistory[mHi-1][0][1],i.remainingSprint=movementHistory[mHi-1][1][0],i.remainingRun=movementHistory[mHi-1][1][1],movementHistory.splice(-1,1))}))}}),Gamer.squaddies.filter(e=>e.isTakenOut).forEach((t,n)=>{t.isTakenOut=!1,t.posX=canvas.width/2+100*n,t.posY=Gamer.deployment[0]<canvas.height/2?t.baseRadius+5:canvas.height-t.baseRadius-5,adminToolz(e,t,Gamer,"comeback"),$("canvas").on("contextmenu",e=>{!t.isActivating&&!t.isMoving&&distance(t.posX,t.posY,mouX,mouY)<=t.baseRadius&&(e.preventDefault(),t.isMoving=!0,t.isActivating=!0),$("canvas").on("click",()=>{t.isActivating&&distance(t.posX,t.posY,mouX,mouY)<=t.remainingSprint&&t.dropper(teamz)})})}))}cheetah(!0),switcher=e=>{Gamer1.active=!Gamer1.active,Gamer2.active=!Gamer2.active,Gamer=Gamer2.active?Gamer2:Gamer1,otherGamer=Gamer2.active?Gamer1:Gamer2,0===Gamer.squaddies.filter(e=>!e.hasActivated).length&&switcher(e),$("canvas").off(),$("#app").empty().off(),$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`);for(let e=0;e<Gamer.squaddies.length;e++){let n=Gamer.squaddies[e],i=n;$("canvas").on("click contextmenu",function(e){if(e.preventDefault(),!n.hasActivated&&Gamer.squaddies.filter(e=>e.isActivating).filter(e=>e.name!==n.name).filter(e=>e.hasMoved||e.hasAttacked||e.hasDropped||e.hasKicked||e.isMoving||e.pressedAbutton||e.hasSnapped).length<1&&Gamer.active&&distance(n.posX,n.posY,mouX,mouY)<n.baseRadius&&$("#app").find(".plajBookCell").length<1){!n.isActivating&&n.isKnockedDown&&(n.hasMoved=!1),n.isActivating=!0,$("#app").css("background","url(./icons/cursor/wood.jpg) 0 0 / 390px"),Gamer.squaddies.filter(e=>!0===e.isActivating).filter(e=>e.name!==n.name).forEach(e=>e.isActivating=!1),message=`left-click on a ${Gamer.guild.name} squaddie model to activate it, or right-click on its model to activate it and display its movement zone.`,$("#appDisplay").slideDown(),$("#app").empty().append(appMaker(Gamer.squaddies.filter(e=>e.isActivating)[0],Gamer))}else Gamer.active&&distance(n.posX,n.posY,mouX,mouY)<n.baseRadius&&n.hasActivated&&($("#app").empty(),$("#app").append(appMaker(Gamer.squaddies.filter(e=>e.isActivating)[0],Gamer)),message=`${n.name} has already activated this turn.`);if($("#app").find(".activeOptions").length<1&&Gamer.active&&distance(n.posX,n.posY,mouX,mouY)<n.baseRadius&&!n.hasActivated&&Gamer.squaddies.filter(e=>e.isActivating).length>0){let e=Gamer.squaddies.filter(e=>e.isActivating)[0];const t=e.hasBall?"Kick the ball by pressing kick button, then either choosing teamate, goal post or pitch within the kick zone.<br>":"",i=otherGamer.squaddies.some(t=>distance(e.posX,e.posY,t.posX,t.posY)<=e.meleeRadius+t.baseRadius)?`Right-click opposing team player icon within melee range of ${e.name} to attack. <br>`:"",o=e.isKnockedDown?"And is knocked down, can't attack, hold the ball or move. <br>":"";message=e.name!==n.name?`${n.name} can't activate in middle of ${e.name} activation. ${e.name} needs to end its activation.`:`${n.name} is activating now. \n                        ${t}\n                        ${i}\n                        ${o}`,$("#app").empty().append(appMaker(Gamer.squaddies.filter(e=>e.isActivating)[0],Gamer))}}),Gamer.isActive&&distance(n.posX,n.posY,m2.posX,m2.posY)<=n.meleeRadius+m2.baseRadius&&(message=`${n.name} can attack enemies in his melee zone with right click on their icon.`,$("#app").empty(),$("#app").append(appMaker(n,Gamer))),$("canvas").on("contextmenu.attacks",e=>{for(let t=0;t<otherGamer.squaddies.length;t++){let n=otherGamer.squaddies[t];e.preventDefault(),i.isActivating&&distance(i.posX,i.posY,n.posX,n.posY)<=i.meleeRadius+n.baseRadius&&distance(mouX,mouY,n.posX,n.posY)<n.baseRadius&&(Boolean(!n.counterForAttack.includes(i.name)||i.isCharging||i.wasCharging)&&otherGamer.momentum>0&&distance(i.posX,i.posY,n.posX,n.posY)<=n.meleeRadius+i.baseRadius?(i.infMin>0&&counterAttackDialogBox(i,n),$("body").on("click.counterattack","#opt1"+n.name,()=>{waaar(Gamer,otherGamer,i,n),n.willCounter=!0,n.counterForAttack.push(i.name),otherGamer.momentum-=1,$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt2"+n.name,()=>{waaar(Gamer,otherGamer,i,n),n.willCounter=!1,$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt3"+n.name,()=>{n.willCounter=!1,n.counterForAttack.push(i.name),waaar(Gamer,otherGamer,i,n),$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt4"+n.name,()=>{waaar(Gamer,otherGamer,i,n),n.willCounter=!0,n.bonusTime=!0,otherGamer.momentum-=2,n.counterForAttack.push(i.name),$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt5"+n.name,()=>{n.defensiveStance=1,otherGamer.momentum-=1,waaar(Gamer,otherGamer,i,n),$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt6"+n.name,()=>{n.defensiveStance=1,otherGamer.momentum-=2,waaar(Gamer,otherGamer,i,n),n.willCounter=!0,n.counterForAttack.push(i.name),$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")}),$("body").on("click.counterattack","#opt7"+n.name,()=>{n.defensiveStance=1,n.bonusTime=!0,otherGamer.momentum-=3,waaar(Gamer,otherGamer,i,n),n.willCounter=!0,n.counterForAttack.push(i.name),$("body").find("#counterbox"+n.name).off().remove(),$("body").off("click.counterattack")})):waaar(Gamer,otherGamer,i,n))}}),$("#app").on("click","#charge"+n.name,()=>{i.infMin>1&&!i.isMoving&&!i.hasMoved&&!i.isCharging&&!i.isKnockedDown&&i.isActivating&&(i.isCharging=!0,i.isMoving=!0,i.isPushed=!1,i.isDodging=!1,message=`${i.name} can now move in a straight line and execute a powerful blow on a enemy in his melee zone.`,$("#app").empty(),$("#app").append(appMaker(n,Gamer)))}),$("canvas").on("click",()=>{i.isCharging&&distance(i.posX,i.posY,mouX,mouY)<=i.charge*inch+i.baseRadius&&!i.hasMoved&&(n.dropper(),i.isMoving=!1,i.hasMoved=!0,i.wasCharging=!0,movementHistory=[])}),$("canvas").on("contextmenu",e=>{e.preventDefault(),!n.hasMoved&&Gamer.active&&distance(n.posX,n.posY,mouX,mouY)<n.baseRadius&&!n.moveAura&&2==e.button&&n.isActivating&&!n.isKnockedDown?(n.moveAura=!0,message=`if ${n.name} has influence, ${n.name} could sprint, left-click to move. You can cancel by pressing escape, hovering beyond movement zone or on other player.`,$("#app").empty(),$("#app").append(appMaker(n,Gamer))):Gamer.active&&distance(n.posX,n.posY,mouX,mouY)<n.baseRadius&&2==e.button&&n.isActivating&&(n.moveAura=!1,n.isMoving=!1,message=`${n.name} has already moved this turn.`,$("#app").empty(),$("#app").append(appMaker(n,Gamer)))}),$("canvas").on("mousedown",function(e){0==e.button&&n.moveAura&&(n.dropper(teamz),n.moveAura=!0,n.isMoving=!0)}),$("#app").on("click","#undoState"+n.name,()=>{fillGameWorld(savedGameState[savedGameState.length-2][0],savedGameState[savedGameState.length-2][1])}),$("#app").on("click",".leaflet"+n.name,()=>{showLeaflet=!showLeaflet}),$("#app").on("click",".passActivation"+n.name,()=>{Gamer.active&&n.isActivating&&(saveGameState(),endSquaddieActivation(n,Gamer1,Gamer2,Gamer,switcher,teamz,t))}),$("#app").on("click","#bonusTime"+n.name,()=>{n.pressedAbutton=!0,Gamer.momentum>0&&!n.bonusTime&&(Gamer.momentum-=1,n.bonusTime=!0,$("#actionButtons").empty().append(actionButtons(n,Gamer)))}),$("#app").on("click","#forfeitMove"+n.name,()=>{n.hasMoved||!n.isKnockedDown||n.isMoving||(n.pressedAbutton=!0,n.hasMoved=!0,n.isKnockedDown=!1,n.meleeZone=n.AmeleeZone,n.meleeRadius=n.baseRadius+n.meleeZone*inch,n.def+=1,$("#actionButtons").empty().append(actionButtons(n,Gamer)),movementHistory=[])}),$("#app").on("click","#healSelf"+n.name,()=>{n.heal<1&&1!==n.removedConditions&&Gamer.momentum>n.isDiseased&&(n.pressedAbutton=!0,healFunction(n,Gamer,4,n.isDiseased?2:1,1),movementHistory=[],$("#actionButtons").empty().append(actionButtons(n,Gamer)))}),$("#app").on("click","#removeConditions"+n.name,()=>{1!==n.heal&&n.removedConditions<1&&Gamer.momentum>n.isDiseased&&(n.pressedAbutton=!0,removeConditionsFuncion(n,Gamer,n.isDiseased?2:1,1),$("#actionButtons").empty().append(actionButtons(n,Gamer)),movementHistory=[])}),$("#app").on("click","#healAFriend"+n.name,()=>{healCursor=1,$("canvas").on("click",()=>{for(let e=0;e<Gamer.squaddies.length;e++){n.pressedAbutton=!0;let t=Gamer.squaddies[e];healCursor>0&&t.heal<1&&t.removedConditions<2&&n.name!==t.name&&Gamer.momentum>(t.isDiseased?2:1)&&distance(mouX,mouY,t.posX,t.posY)<=t.baseRadius&&t.hpMin<t.hp&&t.heal<1&&t.removedConditions<2&&(healFunction(t,Gamer,4,n.isDiseased?3:2,2),$("#actionButtons").empty().off().append(actionButtons(n,Gamer)),healCursor=0,movementHistory=[])}})}),$("#app").on("click","#takeAbreather"+n.name,()=>{healCursor=2;for(let e=0;e<Gamer.squaddies.length;e++){let t=Gamer.squaddies[e];$("canvas").on("click",()=>{n.pressedAbutton=!0,healCursor>0&&t.heal<2&&t.removedConditions<1&&n.name!==t.name&&Gamer.momentum>(t.isDiseased?2:1)&&distance(mouX,mouY,t.posX,t.posY)<=t.baseRadius&&t.removedConditions<1&&t.heal<2&&hasConditions(t)&&(removeConditionsFuncion(t,Gamer,t.isDiseased?3:2,2),movementHistory=[],$("#actionButtons").empty().off().append(actionButtons(n,Gamer)),healCursor=0)})}}),$("#app").on("click",".glide"+i.name,()=>{Gamer.momentum>0&&!i.isGliding?(Gamer.momentum-=1,i.isGliding=!0):i.isGliding&&i.remainingSprint===i.sprint*inch+i.baseRadius&&(Gamer.momentum+=1,i.isGliding=!1)}),$("#app").on("click","#ruler"+i.name,()=>{rulerDopplers=[],ruler=!ruler,$("#players").on("click",()=>{rulerDopplers.length>0&&ruler?rulerDopplers.push([mouX,mouY,rulerDopplers[rulerDopplers.length-1][2],rulerDopplers[rulerDopplers.length-1][3]]):rulerDopplers.length<1&&ruler&&(console.log(rulerDopplers.length),rulerDopplers.push([mouX,mouY,i.posX,i.posY]))})}),teamz.forEach(e=>{$("#app").on("click","#snapBall"+e.name,()=>{!i.isKnockedDown&&i.isActivating&&distance(ball.x,ball.y,e.posX,e.posY)<ball.ballSize+e.baseRadius+1*inch&&ball.isOnGround&&(e.hasSnapped?(message="can't snap the ball now",$("#app").find(".message").text(message)):(teamz.forEach(e=>{e.hasBall&&(e.hasBall=!1)}),ball.x=e.posX,ball.y=e.posY,ball.isOnGround=!1,e.hasBall=!0,e.hasDropped=!1,e.hasSnapped=!0,$("#actionButtons").empty().append(actionButtons(e,Gamer,color=Gamer.guild.color))))})}),$("#app").on("click","#undoMove"+n.name,()=>{let e=i.remainingSprint<26;mHi=movementHistory.length,i.posX=movementHistory[mHi-1][0][0],i.posY=movementHistory[mHi-1][0][1],i.remainingSprint=movementHistory[mHi-1][1][0],i.remainingRun=movementHistory[mHi-1][1][1],i.runPaid&&i.remainingSprint<0&&(i.infMin++,i.runPaid=!1),movementHistory.splice(-1,1);let t=i.remainingSprint>26;i.runPaid&&e&&t&&(i.runPaid=!1,i.infMin++)}),$("#app").on("click","#dropBall"+n.name,()=>{ball.isInHand=!0,ball.drawDropAura(n.baseRadius),$("canvas").on("click",()=>{distance(n.posX,n.posY,mouX,mouY)<=n.baseRadius+1*inch+ball.ballSize&&ball.isInHand&&n.hasBall&&(movementHistory=[],ball.isInHand=!1,n.hasBall=!1,n.hasDropped=!0,ball.isOnGround=!0,n.hasSnapped=!0,ball.x=mouX,ball.y=mouY,snapBallButtonCreator("end",n.name))})}),$("#app").on("click","#kick"+n.name,()=>{n.hasBall?n.has||0!==n.infMin?n.hasBall&&n.infMin>0&&(n.isKicking=!0,ball.beingKicked=!0,message="left-click within aura to: scatter a free ball, or pass to a friendly team mate or score a goal.",$("#app").empty().append(appMaker(i,Gamer))):(message=`${n.name} has ball in possession but lacks influence to kick it.`,$("#app").empty(),$("#app").append(appMaker(n,Gamer))):(message=`${n.name} doeasn't have a ball to be able to kick it.`,$("#app").empty().append(appMaker(n,Gamer)))}),$("canvas").on("click",e=>{if(e.preventDefault(),distance(i.posX,i.posY,ball.x,ball.y)<=i.baseRadius+inch+ball.ballSize&&distance(mouX,mouY,ball.x,ball.y)<=ball.ballSize&&ball.isOnGround&&!i.hasSnapped&&i.isActivating&&!i.isKnockedDown?(ball.isOnGround=!1,i.hasBall=!0,movementHistory=[]):distance(i.posX,i.posY,ball.x,ball.y)<=i.baseRadius+inch+ball.ballSize&&distance(mouX,mouY,ball.x,ball.y)<=ball.ballSize&&ball.isOnGround&&i.hasSnapped&&sendMessage(`${i.name} has dropped the ball, so it can't be picked it up this activation.`),i.isKicking&&ball.beingKicked){if(distance(i.posX,i.posY,otherGamer.gp.x,otherGamer.gp.y)<i.kickDist*inch+i.baseRadius&&distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)<2.5*cm&&i.infMin>0&&Gamer.momentum>0){i.isMoving&&(i.isMoving=!1,i.hasMoved=!0);let e=distance(i.posX,i.posY,otherGamer.gp.x,otherGamer.gp.y)<=i.kickDist*inch/2?3:4,o=diceRoller(Gamer,otherGamer,i,i,"kick"),a=o.filter(t=>t>=e).length;diceRolledForDisplay=[],diceRolled(o,e,Gamer.guild.color),a>0?(n.hasKicked=!0,n.isKicking=!1,n.hasBall=!1,ball.beingKicked=!1,n.infMin-=1,Gamer.momentum-=1,Gamer.goals+=1,Gamer.score+=4,diceRolledForDisplay=[],diceRolled(o,e,Gamer1.guild.color),message=`${i.name} succesfully scored goal, so either dodge or bank a momentum.`,($teamplays=[]).push(`<li class='teamPlays plajBookCell' id='scoreddodge${i.name}'>dodge</li>\n                                            <li class='teamPlays plajBookCell' id='scorebankmomentum${i.name}'>bank momentum</li>`),$("#app").on("click",`#scorebankmomentum${i.name}`,()=>{Gamer.momentum+=1,ball.x=otherGamer.gp.x,ball.y=otherGamer.gp.y,otherGamer.gp.hasBall=!0,otherGamer.gp.isKicking=!0,ball.beingKicked=!0,$teamplays=[],message=`${otherGamer.guild.name} can now resolve goal kick with right-click.`,$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$("canvas").on("contextmenu",e=>{distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)<2.5*cm+10*inch&&(e.preventDefault(),saveGameState(),i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),otherGamer.gp.hasBall=!1,otherGamer.gp.isKicking=!1,ball.beingKicked=!1,endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))})}),$("#app").on("click",`#scoreddodge${i.name}`,()=>{i.isDodging=!0,i.dodgeSquaddie(4),$("canvas").on("click",e=>{e.preventDefault(),otherGamer.gp.hasBall=!0,otherGamer.gp.isKicking=!0,ball.beingKicked=!0,ball.x=otherGamer.gp.x,ball.y=otherGamer.gp.y,otherGamer.gp.hasBall&&otherGamer.gp.isKicking&&($teamplays=[],message=`${otherGamer.guild.name} can now resolve goal kick with right-click`,$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$("canvas").on("contextmenu",e=>{distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)<2.5*cm+10*inch&&(e.preventDefault(),saveGameState(),i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),otherGamer.gp.hasBall=!1,otherGamer.gp.isKicking=!1,ball.beingKicked=!1,endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))}))}),$teamplays=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer))}),$("#app").empty(),$("#app").append(appMaker(i,Gamer))):(diceRolledForDisplay=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer)),n.hasKicked=!0,n.isKicking=!1,n.hasBall=!1,ball.beingKicked=!1,n.infMin-=1,Gamer.momentum-=1,i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),diceRolled(o,e,Gamer1.guild.color),endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))}Gamer.squaddies.forEach(e=>{if(i.hasBall&&distance(i.posX,i.posY,mouX,mouY)<=i.kickDist*inch+e.baseRadius+i.baseRadius&&distance(e.posX,e.posY,mouX,mouY)<e.baseRadius&&i.name!==e.name){i.isMoving&&(i.isMoving=!1,i.hasMoved=!0);let o=distance(i.posX,i.posY,e.posX,e.posY)<=i.kickDist*inch+i.baseRadius/2?3:4,a=diceRoller(Gamer,otherGamer,i,e,"kick"),s=a.filter(e=>e>=o).length;diceRolledForDisplay=[],diceRolled(a,o,Gamer.guild.color),s>0?(i.hasBall=!1,i.hasKicked=!0,i.isKicking=!1,ball.beingKicked=!1,e.hasBall=!0,i.infMin-=1,($teamplays=[]).push(`<li class='teamPlays plajBookCell' id='recdo1${i.name}'>kicker<br>dodges</li>\n                                <li class='teamPlays plajBookCell' id='recdo2${i.name}'>bank<br>momentum</li>\n                                <li class='teamPlays plajBookCell' id='recdo3${i.name}'>receiver<br>dodges</li>`),distance(e.posX,e.posY,otherGamer.gp.x,otherGamer.gp.y)<=e.kickDist*inch+e.baseRadius+2.5*cm&&Gamer.momentum>1&&$teamplays.push(`<li class='teamPlays plajBookCell' id='recdo4${i.name}'>snap<br>shot</li>`),$("#app").on("click",`#recdo1${i.name}`,()=>{i.isDodging=!0,i.dodgeSquaddie(4),$teamplays=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$(`#recdo1${i.name}`).off()}),$("#app").on("click",`#recdo2${i.name}`,()=>{Gamer.momentum+=1,$teamplays=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$("#app").find(`#recdo2${i.name}`).off()}),$("#app").on("click",`#recdo3${i.name}`,()=>{e.isDodging=!0,e.dodgeSquaddie(4),$teamplays=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$(`#recdo3${i.name}`).off()}),$("#app").on("click",`#recdo4${i.name}`,()=>{let o=diceRoller(Gamer,otherGamer,e,i,"kick"),a=distance(e.posX,e.posY,otherGamer.gp.x,otherGamer.gp.y)<=(e.kickDist*inch+e.baseradius+2.5*cm)/2?3:4,s=o.filter(e=>e>=a);Gamer.momentum>1&&s.length>1?(i.hasKicked=!0,i.isKicking=!1,e.hasBall=!1,ball.beingKicked=!1,Gamer.score+=4,Gamer.goals+=1,n.hasKicked=!0,n.isKicking=!1,n.hasBall=!1,ball.beingKicked=!1,diceRolledForDisplay=[],diceRolled(s,a,Gamer1.guild.color),message=`${e.name} succesfully scored goal, so either dodge or bank a momentum.`,($teamplays=[]).push(`<li class='teamPlays plajBookCell' id='scoreddodge${e.name}'>dodge</li>\n                                            <li class='teamPlays plajBookCell' id='scorebankmomentum${i.name}'>bank momentum</li>`),$("#app").on("click",`#scorebankmomentum${i.name}`,()=>{Gamer.momentum+=1,ball.x=otherGamer.gp.x,ball.y=otherGamer.gp.y,otherGamer.gp.hasBall=!0,otherGamer.gp.isKicking=!0,ball.beingKicked=!0,$teamplays=[],message=`${otherGamer.guild.name} can now resolve goal kick`,$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$("canvas").on("contextmenu",e=>{distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)<2.5*cm+10*inch&&(e.preventDefault(),saveGameState(),i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),otherGamer.gp.hasBall=!1,otherGamer.gp.isKicking=!1,ball.beingKicked=!1,endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))})}),$("#app").on("click",`#scoreddodge${e.name}`,()=>{e.isDodging=!0,e.dodgeSquaddie(4),$("canvas").on("click",e=>{e.preventDefault(),otherGamer.gp.hasBall=!0,otherGamer.gp.isKicking=!0,ball.beingKicked=!0,ball.x=otherGamer.gp.x,ball.y=otherGamer.gp.y,otherGamer.gp.hasBall&&otherGamer.gp.isKicking&&($teamplays=[],message=`${otherGamer.guild.name} can now resolve goal kick`,$("#app").empty(),$("#app").append(appMaker(i,Gamer)),$("canvas").on("contextmenu",e=>{distance(mouX,mouY,otherGamer.gp.x,otherGamer.gp.y)<2.5*cm+10*inch&&(e.preventDefault(),saveGameState(),i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),otherGamer.gp.hasBall=!1,otherGamer.gp.isKicking=!1,ball.beingKicked=!1,endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))}))}),$teamplays=[],$("#app").empty(),$("#app").append(appMaker(i,Gamer))}),$("#app").empty(),$("#app").append(appMaker(i,Gamer))):s<2&&(saveGameState(),Gamer.momentum-=1,ball.beingKicked=!1,e.hasBall=!1,i.hasKicked=!0,i.isKicking=!1,movementHistory=[],e.hasDropped=!0,scatterRandomiser(otherGamer.gp.x,otherGamer.gp.y,!0,e),$("#app").empty(),$("#app").append(appMaker(i,Gamer)),endSquaddieActivation(i,Gamer1,Gamer2,Gamer,switcher,teamz,t))}),movementHistory=[],message=`${i.name} succesfully passed to ${e.name}, now you can choose to either dodge or bank a momentum.`,$("#app").empty(),$("#app").append(appMaker(i,Gamer))):(i.isMoving&&(i.isMoving=!1,i.hasMoved=!0),ball.beingKicked=!1,i.hasBall=!1,i.hasKicked=!0,i.isKicking=!1,i.infMin-=1,movementHistory=[],i.hasDropped=!0,diceRolledForDisplay=[],scatterRandomiser(mouX,mouY,!0,i),diceRolled(a,o,Gamer1.guild.color),$("#app").empty(),$("#app").append(appMaker(i,Gamer)))}else if(i.hasBall&&distance(i.posX,i.posY,mouX,mouY)<=i.kickDist*inch+i.baseRadius-ball.ballSize&&i.infMin>0&&Gamer.squaddies.filter(e=>e.name!==i.name).filter(e=>distance(mouX,mouY,e.posX,e.posY)<e.baseRadius).length<1){let e=diceRoller(Gamer,otherGamer,i,i,"kick");i.isMoving&&(i.isMoving=!1,i.hasMoved=!0),i.infMin-=1,i.hasBall=!1,i.isKicking=!1,i.hasKicked=!0,ball.beingKicked=!1,i.hasDropped=!0,diceRolledForDisplay=[],scatterRandomiser(mouX,mouY,!0,i),diceRolled(e,4,Gamer1.guild.color),movementHistory=[],e.filter(e=>e>=4).length>0&&i.kickReRoll<1&&(message=`${i.name} scattered the ball into open field, ready for taking. However if the kick roll was succesfull you can re-roll it once.`,i.kickReRoll++,$("#app").on("click","#kickReRoll"+i.name,()=>{$("body").find(".snapBallButton").remove(),diceRolledForDisplay=[],teamz.forEach(e=>e.hasBall=!1),ball.isOnGround=!1,i.hasBall=!0,ball.x=i.posX,ball.y=i.posY,i.kickReRoll++,diceRolled(e,4,Gamer1.guild.color),scatterRandomiser(neSpotx,neSpoty,!0,i),$("#app").empty().append(appMaker(Gamer.squaddies.filter(e=>e.isActivating)[0],Gamer))})),$("#app").empty(),$("#app").append(appMaker(i,Gamer))}})}}),escapist(i,otherGamer)}$("#app").empty()&&$("#app").append("<div class='the-first-info'>left click to activate player, right click to display move aura, then left click to move player, active players can attack opposing team by right clicking enemise within melee zone\n            , use escape button if you want to cancel i.e. kick or charge. also for the sake and liberty of testing there are only two pre-set teams out of 17 different guilds. Although being a dad and a 42h per week production operator makes developing this game as hard and as slow as possible.</div>")},function e(t){counter<5&&(Gamer1.active=!Gamer1.active,Gamer2.active=!Gamer2.active,Gamer=Gamer2.active?Gamer2:Gamer1,otherGamer=Gamer2.active?Gamer1:Gamer2);let n=()=>0===counter?$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`).append(`<div class='the-first-info'>this is going to be a as close as possible automated replica of a tabletop game called Guild Ball. <br> It'll be no fun for ya if yer know no rulez:<br>\n             <a style="color:rgb(11, 31, 4);font-size:43px;font-weight:900"\n             href = "https://static1.squarespace.com/static/56728f72a128e6b1e548ec55/t/5c755dc3f4e1fc3d9a733219/1551195617029/GB-S4-Rulebook-4-1.pdf" \n             target="_blank">guild ball rules.pdf</a> <br>You're still here? Good.<br>Double left-click, and hold that left click \n             to pick up a player, then drop him as you please. This is deployment phase, there are two teams you control \n             simultaneously, each team can move as they please within their deployment limits, ${Gamer.guild.name} first, then \n             when they're done, assign ball to the kicker and press end deployment.</div>`):1===counter?$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`).append(`<div class='the-first-info'>Double left-click, and hold that left click to pick up a player, then drop him as you please. This is deployment phase, for ${Gamer.guild.name}. Now they can be deployed within their deployment zone limits.</div>`):2===counter?$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`).append(`<div class='the-first-info'> Double right click to initiate movement aura for free jog. ${Gamer.guild.name} player ${Gamer.squaddies.filter(e=>e.hasBall)[0].name} in posession of the ball, has free jog and free kick to opposing team.</div>`):3===counter?$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`).append(`<div class='the-first-info'>Left click on a model to see its panel. Then this is time to assign the influence for ${Gamer.guild.name} which now know where the ball is and will begin the game turn.</div>`):4===counter?$("#app").css("background",`url(./icons/${Gamer.guild.name}/${Gamer.guild.name}.png) 0 -1px / 423px no-repeat, url(./icons/cursor/wood.jpg) 0 0 / 390px`).append(`<div class='the-first-info'>Left click on a model to see its panel. Then this is time to assign the influence for ${Gamer.guild.name} which now know where the ball is, where starting's team influence is invested and will ending turn activation, which can be a powerful tool.</div>`):"";n(),$("canvas").empty().off(),$("#app").empty().off(),counter<2?($("canvas").on("click contextmenu",function(t){t.preventDefault();for(let n=0;n<Gamer.squaddies.length;n++){let i=Gamer.squaddies[n];distance(i.posX,i.posY,mouX,mouY)<i.baseRadius&&($("#app").css("background","url(./icons/cursor/wood.jpg) 0 0 / 390px"),message=counter<1?`double left-click to drag and drop ${Gamer.guild.name} squaddie model within deployment zone. Don't forget to allocate the Ball.`:`left-click to drag and drop ${Gamer.guild.name} squaddie model within deployment zone.`,$("#appDisplay").slideDown(),$("#app").empty().off(),$("#app").append(appMaker(i,Gamer)),adminToolz(t,i,Gamer,"deployment"),$("#app").on("click",".leaflet"+i.name,()=>{showLeaflet=!showLeaflet}),$("#app").on("click",".passActivation"+i.name,()=>{Gamer.active&&teamz.filter(e=>e.hasBall).length>0?(counter++,e(t)):(message="you hve to allocate ball to the initial kicker first",$("#app").find(".message").text(message))}),$("#app").on("click",".giveBallTo"+i.name,()=>{teamz.forEach(e=>{e.hasBall&&(e.hasBall=!1)}),ball.x=void 0,ball.y=void 0,ball.isOnGround=!1,i.hasBall=!0}))}}),n()):2===counter?($("canvas").on("click contextmenu",function(t){t.preventDefault();for(let n=0;n<Gamer.squaddies.length;n++){let i=Gamer.squaddies[n];if(distance(i.posX,i.posY,mouX,mouY)<i.baseRadius&&i.hasBall)$("#app").css("background","url(./icons/cursor/wood.jpg) 0 0 / 390px"),message=`right-click to walk ${i.name} and left-click to confirm where to move, then left-click on kick button to kick off!`,$("#appDisplay").slideDown(),$("#app").empty().off(),$("#app").append(appMaker(i,Gamer)),$("#app").on("click",".leaflet"+i.name,()=>{showLeaflet=!showLeaflet}),$("#app").on("click",".passActivation"+i.name,()=>{Gamer.active&&i.hasBall?(message="gotta kick off first",$("#app").empty().off(),$("#app").append(appMaker(i,Gamer))):i.hasBall||($("#app").empty().off(),counter++,e(t))}),escapist(i,otherGamer),$("canvas").on("click contextmenu",e=>{e.preventDefault(),distance(i.posX,i.posY,mouX,mouY)<=i.remainingSprint&&i.hasBall&&!i.isKicking&&(i.isMoving=!0,i.isActivating=!0,i.dropper(teamz))}),$("#app").on("click","#kick"+i.name,()=>{i.hasBall&&(i.isMoving=!1,i.isActivating=!1,i.isKicking=!0,ball.beingKicked=!0,message="the ball has to completely pass your half of the pitch, otherwise opponent will be allowed to assign ball to a squaddie of their choosing.",$("#app").empty().append(appMaker(i,Gamer)))}),$("#app").on("click","#undoMove"+i.name,()=>{mHi=movementHistory.length,i.posX=movementHistory[mHi-1][0][0],i.posY=movementHistory[mHi-1][0][1],i.remainingSprint=movementHistory[mHi-1][1][0],i.remainingRun=movementHistory[mHi-1][1][1],movementHistory.splice(-1,1)}),$("canvas").on("click",n=>{if(n.preventDefault(),i.isKicking&&ball.beingKicked&&distance(i.posX,i.posY,mouX,mouY)<=i.kickDist*inch+i.baseRadius){n.preventDefault(),i.hasMoved=!1,i.isMoving=!1,i.remainingSprint=i.sprint*inch+i.baseRadius,i.remainingRun=i.run*inch+i.baseRadius,i.hasBall=!1,i.isKicking=!1,ball.beingKicked=!1;let o=diceRoller(Gamer,otherGamer,i,i,"kick");if(Gamer.momentum+=1,movementHistory=[],i.hasDropped=!0,scatterRandomiser(mouX,mouY,!0,i),diceRolled(o,4,Gamer1.guild.color),o.filter(e=>e>=4).length>0&&i.kickReRoll<2){message=`${i.name} scattered the ball into open field, ready for taking. However if the kick roll was succesfull you can re-roll it once.`;let n=mouX,o=mouY;i.kickReRoll++,$("#app").empty().off(),$("#app").on("click","#kickReRoll"+i.name,()=>{diceRolledForDisplay=[],teamz.forEach(e=>e.hasBall=!1),ball.isOnGround=!1,i.hasBall=!0,ball.x=i.posX,ball.y=i.posY,i.kickReRoll++,scatterRandomiser(n,o,!0,i),$("#app").empty(),counter++,i.isActivating=!1,e(t)}),$("#app").on("click",".passActivation"+i.name,()=>{$("#app").empty().off(),counter++,e(t)}),$("#app").append(appMaker(i,Gamer))}else i.isActivating=!1,diceRolledForDisplay=[],i.kickReRoll++,counter++,$("#app").empty(),e(t)}});else if(distance(i.posX,i.posY,mouX,mouY)<i.baseRadius&&!i.hasBall){let e=teamz.filter(e=>e.hasBall)[0];message=`you must perform kick off with ${e.name}.`,$("#app").empty().off(),$("#app").append(appMaker(e,Gamer))}}}),n()):3===counter||4===counter?($("canvas").on("click contextmenu",function(t){t.preventDefault();for(let n=0;n<Gamer.squaddies.length;n++){let i=Gamer.squaddies[n];distance(i.posX,i.posY,mouX,mouY)<i.baseRadius&&($("#app").css("background","url(./icons/cursor/wood.jpg) 0 0 / 390px"),message="time to allocate influence to each player.",$("#appDisplay").slideDown(),$("#app").empty().off(),actionButtons(i,Gamer),$("#app").append(appMaker(i,Gamer)),$("#app").on("click",".addInf"+i.name,()=>{Gamer.active&&Gamer.influence>0&&i.infMin<i.infMax&&(Gamer.influence-=1,i.infMin+=1,$("#actionButtons").empty().off().append(actionButtons(i,Gamer)))}),$("#app").on("click",".minInf"+i.name,()=>{Gamer.active&&i.infMin>0&&(Gamer.influence+=1,i.infMin-=1,$("#actionButtons").empty().off().append(actionButtons(i,Gamer)))}),$("#app").on("click",".leaflet"+i.name,()=>{showLeaflet=!showLeaflet}),$("#app").on("click",".passActivation"+i.name,()=>{Gamer.active&&0===Gamer.influence?(counter++,e(t)):(message="allocate all influence first",$("#app").empty().off(),$("#app").append(appMaker(i,Gamer)))}),$("#app").on("click",".giveBallTo"+i.name,()=>{teamz.forEach(e=>{e.hasBall&&(e.hasBall=!1)}),ball.x=void 0,ball.y=void 0,ball.isOnGround=!1,i.hasBall=!0}))}}),n()):counter>4&&switcher(t)}(event)}),document.addEventListener("DOMContentLoaded",function(e){let t=260;Gamer1.squaddies.forEach(e=>{t+=80,e.posX=t,e.posY=80});let n=260;Gamer2.squaddies.forEach(e=>{n+=80,e.posX=n,e.posY=1010}),function e(t){for(let e=0;e<Gamer1.squaddies.length;e++){let t=Gamer1.squaddies[e];for(let e=0;e<Gamer2.squaddies.length;e++){let n=Gamer2.squaddies[e];if(t===n)t.meleeColor=grayColor;else if(distance(t.posX,t.posY,n.posX,n.posY)>t.meleeRadius+n.baseRadius)t.meleeColor=grayColor;else if(distance(t.posX,t.posY,n.posX,n.posY)<=t.meleeRadius+n.baseRadius){t.meleeColor=redColor;break}}for(let e=0;e<Gamer2.squaddies.length;e++){let n=Gamer2.squaddies[e];if(t===n)t.dopplerColor=grayColor;else if(distance(mouX,mouY,n.posX,n.posY)>t.meleeRadius+n.baseRadius)t.dopplerColor=grayColor;else if(distance(mouX,mouY,n.posX,n.posY)<=t.meleeRadius+n.baseRadius){t.dopplerColor=redColor;break}}}for(let e=0;e<Gamer2.squaddies.length;e++){let t=Gamer2.squaddies[e];for(let e=0;e<Gamer1.squaddies.length;e++){let n=Gamer1.squaddies[e];if(t===n)t.meleeColor=grayColor;else if(distance(t.posX,t.posY,n.posX,n.posY)>t.meleeRadius+n.baseRadius)t.meleeColor=grayColor;else if(distance(t.posX,t.posY,n.posX,n.posY)<t.meleeRadius+n.baseRadius){t.meleeColor=redColor;break}}for(let e=0;e<Gamer1.squaddies.length;e++){let n=Gamer1.squaddies[e];if(t===n)t.dopplerColor=grayColor;else if(distance(mouX,mouY,n.posX,n.posY)>t.meleeRadius+n.baseRadius)t.dopplerColor=grayColor;else if(distance(mouX,mouY,n.posX,n.posY)<t.meleeRadius+n.baseRadius){t.dopplerColor=redColor;break}}}for(let e=0;e<teamz.length;e++){let t=teamz[e];terrainsDetector(t),t.isTakenOut&&(t.posX=void 0,t.posY=void 0);for(let e=0;e<teamz.length;e++){let n=teamz[e];if(Boolean(counter<2||counter>5)&&t.name!=n.name&&distance(t.posX,t.posY,n.posX,n.posY)<t.baseRadius+n.baseRadius){let e=t.posX<n.posX?-t.baseRadius:t.baseRadius,i=t.posY<n.posY?-t.baseRadius:t.baseRadius,o=n.posX,a=n.posY;t.posX=t.posX+e/20,t.posY=t.posY+i/20,n.posX=o,n.posY=a}else if(distance(t.posX,t.posY,Gamer.gp.x,Gamer.gp.y)<t.baseRadius+2.5*cm){let e=t.posX<Gamer.gp.x?-t.baseRadius:t.baseRadius,i=t.posY<Gamer.gp.y?-t.baseRadius:t.baseRadius,o=n.posX,a=n.posY;t.posX=t.posX+e/20,t.posY=t.posY+i/20,n.posX=o,n.posY=a}else if(distance(t.posX,t.posY,otherGamer.gp.x,otherGamer.gp.y)<t.baseRadius+2.5*cm){let e=t.posX<otherGamer.gp.x?-t.baseRadius:t.baseRadius,n=t.posY<otherGamer.gp.y?-t.baseRadius:t.baseRadius;t.posX=t.posX+e/20,t.posY=t.posY+n/20}else t.oldX=t.posX,t.oldY=t.posY;t.isPushed||(t.posX<t.baseRadius?t.posX=t.baseRadius:t.posY<t.baseRadius?t.posY=t.baseRadius:canvas.height<t.posY+t.baseRadius?t.posY=canvas.height-t.baseRadius:canvas.width<t.posX+t.baseRadius&&(t.posX=canvas.width-t.baseRadius)),counter<2&&"top"===Gamer.side?Gamer.squaddies.filter(e=>e.posY>10*inch-e.baseRadius).forEach(e=>e.posY=10*inch-e.baseRadius):counter<2&&"bottom"===Gamer.side&&Gamer.squaddies.filter(e=>e.posY<canvas.height-10*inch+e.baseRadius).forEach(e=>e.posY=canvas.height-10*inch+e.baseRadius),t.name!==n.name&&t.hasBall&&n.hasBall&&(n.hasBall=!1)}t.moveAura&&0===t.infMin&&!t.runPaid&&distance(mouX,mouY,t.posX,t.posY)>t.remainingSprint-t.baseRadius&&(t.moveAura=!1),t.hpMin<1&&(generatePuddle(t),removeConditionsFuncion(t,Gamer,0,0),t.isActivating=!1,t.hasActivated=!1,t.isMoving=!1,t.hasMoved=!1,t.isAttacking=!1,t.hasAttacked=!1,t.isKicking=!1,t.hasKicked=!1,t.hasSnapped=!1,t.hasDroped=!1,t.isBleeding=!1,t.isBurning=!1,t.isDiseased=!1,t.isKnockedDown=!1,t.isPoisoned=!1,t.isSnared=!1,t.removedConditions=0,t.bonusTime=!1,t.pressedAbutton=!1,t.hasSnapped=!1,t.isTakenOut||(Gamer.score+=2,Gamer.momentum+=1,t.hasBall&&(t.hasBall=!1,ball.isOnGround=!0,scatterRandomiser(t.posX,t.posY,!1)),t.hpMin=t.icySponge,t.posX=void 0,t.posY=void 0,t.hasActivated=!0,t.hasMoved=!0,t.isPushed=!1,t.isDodging=!1,t.isTakenOut=!0,plajBookWraz(),t.isBurning=!1,t.isBleeding=!1,t.isDiseased=!1,t.isKnockedDown=!1,t.isPoisoned=!1,t.isSnared=!1)),(t.posX>canvas.width-t.baseRadius||t.posY>canvas.height-t.baseRadius||t.posX<=t.baseRadius||t.posY<=t.baseRadius)&&t.isPushed&&!t.isTakenOut&&(Gamer.score+=2,Gamer.momentum+=1,t.hasBall&&(t.hasBall=!1,ball.x=canvas.width/2,ball.y=canvas.height/2,ball.isOnGround=!0,scatterRandomiser(canvas.width/2,canvas.height/2,!1)),removeConditionsFuncion(t,Gamer,0,0),t.isActivating=!1,t.hasActivated=!1,t.isMoving=!1,t.hasMoved=!1,t.isAttacking=!1,t.hasAttacked=!1,t.isKicking=!1,t.hasKicked=!1,t.isBleeding=!1,t.isBurning=!1,t.isDiseased=!1,t.isKnockedDown=!1,t.isPoisoned=!1,t.isSnared=!1,t.removedConditions=0,t.bonusTime=!1,t.pressedAbutton=!1,t.posX=void 0,t.posY=void 0,t.hasActivated=!0,t.hasMoved=!0,t.isPushed=!1,t.isDodging=!1,t.isTakenOut=!0,plajBookWraz(),t.posX=void 0,t.posY=void 0),(t.moveAura&&distance(mouX,mouY,t.posX,t.posY)>=t.remainingRun+10-t.baseRadius&&t.moveAura||t.remainingRun<.58*inch)&&(t.moveAura=!1),t.moveAura&&distance(mouX,mouY,t.posX,t.posY)<=t.remainingRun-t.baseRadius&&t.moveAura&&(t.oldX=t.posX,t.oldY=t.posY),distance(t.posX,t.posY,t.oldX,t.oldY)>t.remainingRun+10&&t.moveAura&&(t.moveAura=!1,t.posX=t.oldX,t.posY=t.oldY),t.hasBall&&(ball.x=t.posX,ball.y=t.posY),(ball.x>canvas.width||ball.x<0||ball.y>canvas.height||ball.y<0)&&(t.hasBall=!1,ball.isOnGround=!0,ball.x=canvas.width/2,ball.y=canvas.height/2,scatterRandomiser(canvas.width/2,canvas.height/2,!1)),t.dragOk&&(t.meleeColor=yellowColor)}!function(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),pcl.clearRect(0,0,pcl.canvas.width,pcl.canvas.height),sctx.clearRect(0,0,sctx.canvas.width,sctx.canvas.height),terrainsGenerator(),drawDeploymentZones(counter),ball.doppler(),Gamer1.gp.drawGoalPost(Gamer1.momentum,Gamer1.score,Gamer1.influence),Gamer2.gp.drawGoalPost(Gamer2.momentum,Gamer2.score,Gamer2.influence),ball.draw_ball(),ball.drawDropAura();for(let e=0;e<teamz.length;e++){let t=teamz[e];t.moveAuraf(),t.kickAura(),t.isDodgingAura(),t.isPushedAura(),t.doppler(mouX,mouY,.5),t.drawPlayerIcon(),t.playerStatus(),distance(t.posX,t.posY,mouX,mouY)<=t.baseRadius&&showLeaflet&&modelInfo(t),rulerDopplers.length>0&&rulerDopplers.forEach(e=>{t.doppler(e[0],e[1],.5,e[2],e[3])}),puddles.forEach(e=>{drawPuddle(ctx,e.size,.5,e.x,e.y,e.shape)})}mouse(Gamer,otherGamer,ball)}(),requestAnimationFrame(e)}(),function(){switch(backgroundTtoss){case 1:case 2:document.querySelector("#pitchfield").style.backgroundImage="url(./icons/Pitch/02.jpg)";break;case 3:document.querySelector("#pitchfield").style.backgroundImage="url(./icons/Pitch/03.jpg)";break;case 4:document.querySelector("#pitchfield").style.backgroundImage="url(./icons/Pitch/04.jpg)";break;case 5:document.querySelector("#pitchfield").style.backgroundImage="url(./icons/Pitch/05.jpg)"}}(),pitchConstructor()});const cheetah=e=>{e||(counter=5,Gamer1.squaddies.forEach(e=>e.posY=400),Gamer2.squaddies.forEach(e=>e.posY=600),teamz.forEach(e=>e.infMin+=6),Gamer1.momentum+=10,Gamer2.momentum+=10)};